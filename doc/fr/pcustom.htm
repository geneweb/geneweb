<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <title>GeneWeb - Personnalisation des pages</title>
</head>
<body background="../images/gwback.jpg">
<table border=0 width="100%">
<tr>
<td>
<a href="http://opensource.geneanet.org/projects/geneweb/"><img 
 src="../images/gwlogo.png" align=left border=0 alt=GeneWeb></a>
</td>
<td align=left>
<h1><font color=#2f6400>GeneWeb:<br>Personnalisation des pages</font></h1>
</td>
</tr>
</table>
</font>
<br><br>


Cette partie indique comment personnaliser les pages d'accueil et les
autres pages et mettre des pages associ&eacute;es. Elle s'adresse aux
personnes ayant d&eacute;j&agrave; un peu manipul&eacute; <font
color=#2f6400><b>GeneWeb</b></font> et qui veulent entrer dans les
d&eacute;tails.

<ul>

<li> <a href="#Wel">Page d'accueil</a>

<li> <a href="#Mac">Macros</a>

<li> <a href="#Ass">Pages associ&eacute;es</a>

<li> Personnalisation de <a href="#All">toutes les pages</a>

</ul>

<hr>
<h3><a name="Wel">
</a> <font color=#2f6400> Page d'accueil </font></a></h3>


La page d'accueil est construite &agrave; partir de fichiers texte,
les fichiers "start.txt" fournis avec la distribution de
<font color=#2f6400><b>GeneWeb</b></font>. Il est possible de modifier ces fichiers et/ou d'en
faire une version sp&eacute;cifique pour une base de donn&eacute;es.

<p>

Ces fichiers contiennent du HTML m&eacute;lang&eacute; avec des
"macros" (voir section suivante). Si vous voulez cr&eacute;er de tels
fichiers ou les modifier, n'utilisez pas d'&eacute;diteur de HTML,
mais un &eacute;diteur de textes normal.

<p>

Pour construire la page d'accueil de la base "toto", <font color=#2f6400><b>GeneWeb</b></font>
va chercher parmi les fichiers suivants, dans cet ordre:

<ul>

<li>bdir/lang/lg/toto.txt

<li>hdir/lang/lg/toto.txt

<li>bdir/lang/toto.txt

<li>hdir/lang/toto.txt

<li>bdir/lang/lg/start.txt

<li>hdir/lang/lg/start.txt

<li>bdir/lang/start.txt

<li>hdir/lang/start.txt

</ul>

o&ugrave;:

<ul>

<li>"bdir" = valeur de "-bd" de la commande "gwd" (d&eacute;faut:
r&eacute;pertoire courant).

<li>"hdir" = valeur de "-hd" de la commande "gwd" (d&eacute;faut:
r&eacute;pertoire courant).

<li>"lg" = langue courante.

</ul>

<p>

Les fichiers "hdir/lang/lg/start.txt" sont fournis avec la
distribution. Pour vous faire un fichier personnalis&eacute;, le plus
simple est de partir d'une copie d'un fichier "start.txt" que vous
arrangerez &agrave; votre fa&ccedil;on. Si la pr&eacute;sentation des
fichiers "start.txt" ne vous plait pas, vous pouvez aussi les changer
directement.

<p>

Attention cependant: d'une version de <font color=#2f6400><b>GeneWeb</b></font> &agrave;
l'autre, les fichiers "start.txt" peuvent &ecirc;tre
am&eacute;lior&eacute;s. Si vous prenez une nouvelle version et voulez
profiter des am&eacute;liorations, regardez si les fichiers
"start.txt" ont &eacute;t&eacute; modifi&eacute;s et incluez leurs
modifications dans vos fichiers personnalis&eacute;s.

<hr>
<h3><a name="Mac">
</a> <font color=#2f6400>Macros</font></a></h3>


Comme indiqu&eacute; pr&eacute;c&eacute;demment, les fichiers de pages
d'accueil ne sont pas du pur HTML. Ils contiennent des "macros". Ce
sont des s&eacute;quences commen&ccedil;ant par le caract&egrave;re
"%" et suivis par une lettre. Exemples: "%s", "%x", etc.

<p>

Ces macros sont remplac&eacute;es par des valeurs qui d&eacute;pendent
du contexte: nom de la base, langue, nombre de personnes dans la base,
etc.

<p>

Il y a &eacute;galement un traitement particulier pour les crochets
"[" et "]": s'il y a un texte entre crochets, il est traduit dans la
langue courante &agrave; partir du lexique (fichier "lexicon.txt")
avec les modifications suivantes:

<ul>

<li>S'il y a une &eacute;toile apr&egrave;s le crochet ouvrant, la
premi&egrave;re lettre de la traduction est convertie en majuscule.

<li>Si le crochet fermant est suivi d'un nombre, cela correspond
&agrave; la n-&egrave;me occurrence de la traduction
(commen&ccedil;ant &agrave; 0), les occurrences &eacute;tant
s&eacute;par&eacute;es par des "/". Si cette occurrence n'existe pas,
c'est la premi&egrave;re qui est prise.

</ul>

<p>

Pour comprendre comment les macros sont utilis&eacute;es, le mieux est
de regarder les fichiers "start.txt" fournis avec la distribution.

<p>

Voici le sens des macros "%":

<ul>

<li><strong>Base.</strong><br>

<ul>

<li>"<font size=+1><tt>%t</tt></font>" : nom de la base.

<li>"<font size=+1><tt>%f</tt></font>" : en mode serveur, nom de la
base, suivi de l'eventuel mot de passe (ex: "toto_xyzzy"); en mode
CGI, nom de la commande CGI (ex: "gwd.exe").

<li>"<font size=+1><tt>%g</tt></font>" : en mode serveur, comme "%f";
en mode CGI, nom de la commande CGI suivi de "?b=", du nom de la base
et d'un point-virgule (ex: "gwd.exe?b=toto;").

<li>"<font size=+1><tt>%s</tt></font>" : valeur de "%f" suivi d'un
point d'interrogation et des variables contextuelles (voir ci-dessous)
suivies d'un point-virgule. Ex: "toto?lang=it;iz=8233;".

</ul>

<li><strong>Compte.</strong><br>

<ul>

<li>"<font size=+1><tt>%c</tt></font>" : nombre d'acc&egrave;s
&agrave; la page d'accueil.

<li>"<font size=+1><tt>%q</tt></font>" : nombre de requ&ecirc;tes.

<li>"<font size=+1><tt>%d</tt></font>" : date de la premi&egrave;re
consultation.

</ul>

<li><strong>Conditionnels.</strong><br>

Les conditionnels commencent par "<font size=+1><tt>%I</tt></font>"
suivi d'une expression bool&eacute;enne (vrai ou faux) et se terminent
par "<font size=+1><tt>%E</tt></font>". Le texte entre ces deux macros
est affich&eacute; si et seulement si l'expression bool&eacute;enne
est vraie. Une expression bool&eacute;enne est soit:

<ul>

<li>"<font size=+1><tt>f</tt></font>" : on est "ami"

<li>"<font size=+1><tt>w</tt></font>" : on est "magicien"

<li>"<font size=+1><tt>j</tt></font>" : on est "magicien" juste "ami"
(cf <a href="start.htm#Cnf">fichier a.gwf</a>, "wizard_just_friend")

<li>"<font size=+1><tt>c</tt></font>" : on est en mode cgi

<li>"<font size=+1><tt>h</tt></font>" : il y a un fichier historique

<li>"<font size=+1><tt>l</tt></font>" : le navigateur ne traite pas les tables

<li>"<font size=+1><tt>n</tt></font>" : il y a des notes pour la base
de donn&eacute;es

<li>"<font size=+1><tt>t</tt></font>" : il y a une recherche par titres de
noblesse

<li>"<font size=+1><tt>z</tt></font>" : il y a une personne prise
comme r&eacute;f&eacute;rence Sosa (voir macro "<font
size=+1><tt>%u</tt></font>")

<li>"<font size=+1><tt>a</tt></font>" : il y a une <a
href="access.htm#DBA">restriction globale d'acc&egrave;s</a> &agrave;
la base de donn&eacute;es

<li>"<font size=+1><tt>N</tt></font>" : contraire de l'expression qui suit

<li>"<font size=+1><tt>|</tt></font>" : "ou" logique entre les deux
expressions qui suivent

<li>"<font size=+1><tt>&amp;</tt></font>" : "et" logique entre les deux
expressions qui suivent

</ul>

Exemples:

<ul>

<li> afficher le texte s'il y a une recherche par titre: <font
size=+1><tt>%It...%E</tt></font>

<li> afficher le texte si on est ni "magicien" ni "ami": <font
size=+1><tt>%I&amp;NwNf...%E</tt></font>

</ul>

<li><strong>Divers.</strong><br>

<ul>

<li>"<font size=+1><tt>%r</tt></font>" suivi d'un nom et d'un
retour-ligne : inclusion du fichier "nom.txt".

<li>"<font size=+1><tt>%b</tt></font>" : valeur de la variable
"body_prop" du fichier "toto.gwf" pour la base "toto".

<li>"<font size=+1><tt>%h</tt></font>" : variables contextuelles (voir
ci-dessous) sous la forme "&lt;input type=hidden name=var
value=val&gt".

<li>"<font size=+1><tt>%l</tt></font>" : langue.

<li>"<font size=+1><tt>%n</tt></font>" : nombre de personnes de la
base.

<li>"<font size=+1><tt>%u</tt></font>" : personne prise comme
r&eacute;f&eacute;rence Sosa.

<li>"<font size=+1><tt>%%</tt></font>" : un seul "%".

<li>"<font size=+1><tt>%[</tt></font>" : un "[".

<li>"<font size=+1><tt>%]</tt></font>" : un "]".

</ul>

</ul>

<p>

Certaines macros font r&eacute;f&eacute;rences &agrave; des
<strong>variables contextuelles</strong>. Ce sont:

<ul>

<li>b : en mode CGI, nom de la base.

<li>lang : langue.

<li>iz : num&eacute;ro de l'&eacute;ventuelle personne prise comme
r&eacute;f&eacute;rence Sosa.

</ul>

<p>

<hr>
<h3><a name="Ass">
</a> <font color=#2f6400> Pages associ&eacute;es </font></a></h3>

Dans votre page d'accueil personnalis&eacute;e, vous pouvez mettre des
liens vers des fichiers associ&eacute;s qui seront trait&eacute;s par
<font color=#2f6400><b>GeneWeb</b></font> de la m&ecirc;me fa&ccedil;on: les macros y seront
transform&eacute;es.

<p>

Par exemple, si vous voulez mettre une page sp&eacute;ciale sur les
personnes c&eacute;l&egrave;bres de votre base, faites un fichier que
vous nommerez "celebres.txt" et que vous mettrez dans le
r&eacute;pertoire "bdir/lang/lg" ou le r&eacute;pertoire "bdir/lang"
(voir premi&egrave;re section).

<p>

La requ&ecirc;te d'acc&egrave;s &agrave; "celebres.txt"
s'&eacute;crit: "m=H;v=celebres". Dans la page d'accueil, vous mettrez
donc:

<pre>
   Les gens &lt;a href="%sm=H;v=celebres"&gt;c&eacute;l&egrave;bres&lt;/a&gt;
   de ma base.
</pre>

<p>

Dans "celebres.txt", vous pourrez mettre des liens vers des personnes
de votre base, ind&eacute;pendamment de son nom et du contexte, en
utilisant les bonnes macros.

<p>

Les macros particuli&egrave;rement int&eacute;ressantes sont:

<ul>

<li>"<font size=+1><tt>%b</tt></font>" que vous pourrez mettre dans le
tag "&lt;body&gt;" en l'&eacute;crivant "&lt;body%b&gt;".

<li>"<font size=+1><tt>%s</tt></font>" que vous pourrez mettre dans les
liens.

</ul>

Exemple de phrase dans "celebres.txt":

<pre>
   Voyez mon cousin &lt;a href="%sp=louis;n=de+bourbon;oc=5"&gt;
   Louis XIV&lt;/a&gt; et mes
   &lt;a href="%sem=R;ep=jean;en=dupont;m=NG;n=louis+xiv;t=PN"&gt;
   liens de parent&eacute;&lt;/a&gt; avec lui.
</pre>

<p>

Voyez &eacute;galement comment faire correctement des <a
href="links.htm">liens</a> vers des pages de <font color=#2f6400><b>GeneWeb</b></font>.

<p>

Remarquez que la "requ&ecirc;te &eacute;volu&eacute;e" fonctionne comme
un fichier associ&eacute;, de nom "advanced.txt".

<p>

<hr>
<h3><a name="All">
</a> <font color=#2f6400>Toutes les pages</font></a></h3>

Les pages, y compris la page d'accueil, peuvent &ecirc;tre
personnalis&eacute;es &agrave; trois endroits:

<ul>

<li>Vous pouvez ajouter un fichier de nom <b>base.hed</b> (si "base"
est le nom de votre base de donn&eacute;es) qui sera
ins&eacute;r&eacute; dans tous les en-t&ecirc;tes des pages (entre
&lt;head&gt; et &lt;/head&gt;). Permet d'y ins&eacute;rer des feuilles
de style, par exemple. &Agrave; mettre dans le r&eacute;pertoire
"lang" et/ou, si vous voulez qu'il soit diff&eacute;rent pour la
langue "xy" dans le r&eacute;pertoire "lang/xy".

<li>De m&ecirc;me, vous pouvez ajouter un fichier de nom
<b>base.trl</b> qui sera ins&eacute;r&eacute; derri&egrave;re le
copyright de GeneWeb &agrave; chaque page.

<li>Enfin, vous avez la possibilit&eacute; de positionner la variable
<tt>body_prop</tt> de votre fichier <b>base.gwf</b> qui sera
ins&eacute;r&eacute; dans la balise "&lt;body&gt;" de toutes les
pages. Utile pour mettre une couleur ou un motif de fond, ou pour
changer les couleurs des textes affich&eacute;s. Voir cette <a
href="start.htm#Cnf">section</a> du chapitre "comment d&eacute;marrer
avec GeneWeb".

</ul>

<p>
<hr>
<br>
<center>Retour vers <a href="diruse.htm">Mode d'Emploi</a></center>

<p><hr><font size=-1><em>Copyright (c) 1998-2006 INRIA -
GeneWeb</em></font><br>
</body>
