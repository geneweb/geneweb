# Configuration principale des tests Geneweb - YAML pour lisibilité
project:
  name: "Geneweb Tests"
  version: "1.0.0"
  description: "Tests pour l'implémentation Python de Geneweb"

# Configuration globale
global:
  coverage_threshold: 85
  timeout_default: 10
  reports_dir: "tests/reports"
  parallel_jobs: 4
  retry_failed: 2
  python_path: "python"

# Binaires supportés - Configuration lisible
binaries:
  consang:
    description: "Calculateur de consanguinité"
    enabled: true
    python_module: "python.consang"
    ocaml_binary: "./distribution/gw/consang"

    # Suites de tests activées
    test_suites:
      unit:
        enabled: true
        path: "tests/unit/python/test_consang/"
        files: ["test_core_functionality.py"]
        timeout: 30
        markers: ["unit", "consang"]

      integration:
        enabled: true
        path: "tests/integration/"
        files: ["test_consang_simple.py"]
        timeout: 60
        markers: ["integration", "consang"]

      golden:
        enabled: true
        # Référence vers les données JSON
        data_file: "golden_data.json"
        success_threshold: 80
        timeout: 30
        markers: ["golden", "consang"]

      performance:
        enabled: true
        path: "tests/performance/"
        files: ["test_consang_simple.py"]
        max_startup_time: 3.0
        max_memory_mb: 100
        markers: ["performance", "consang"]

  # Autres binaires (désactivés pour l'instant)
  gwc:
    description: "Compilateur de base de données"
    enabled: false
    python_module: "python.gwc"
    ocaml_binary: "./distribution/gw/gwc"

  gwd:
    description: "Démon web"
    enabled: false
    python_module: "python.gwd"
    ocaml_binary: "./distribution/gw/gwd"

  ged2gwb:
    description: "Convertisseur GEDCOM vers GWB"
    enabled: false
    python_module: "python.ged2gwb"
    ocaml_binary: "./distribution/gw/ged2gwb"

# Configuration pytest
pytest:
  options:
    - "-v"
    - "--tb=short"
    - "--strict-markers"
    - "--cov=python"
    - "--cov-report=term-missing"
    - "--cov-fail-under=80"
    - "--html=tests/reports/report.html"
    - "--self-contained-html"

  markers:
    - "unit: Tests unitaires"
    - "integration: Tests d'intégration"
    - "golden: Tests Golden Master"
    - "performance: Tests de performance"
    - "consang: Tests spécifiques à consang"
    - "gwc: Tests spécifiques à gwc"
    - "gwd: Tests spécifiques à gwd"
    - "ged2gwb: Tests spécifiques à ged2gwb"
    - "slow: Tests lents"

  testpaths:
    - "tests/unit"
    - "tests/integration"
    - "tests/golden_master"
    - "tests/performance"

# Configuration des environnements
environment:
  python_version: ">=3.8"
  required_commands: ["consang"]
  virtual_env_path: "legacy"

  # Variables d'environnement pour les tests
  env_vars:
    PYTHONPATH: "python"
    GENEWEB_TEST_MODE: "true"
