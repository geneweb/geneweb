<!DOCTYPE html>
<html lang="%if;(bvar.default_lang!="" and evar.lang="")%bvar.default_lang;%elseif;(evar.lang!="")%evar.lang;%else;en%end;">
<head>
  <!-- $Id: updfam.txt,v 7.00 10/11/2016 09:45:03 $ -->
  <!-- Copyright (c) 1998-2017 INRIA -->
  <meta name="robots" content="none">
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="shortcut icon" href="%image_prefix;/favicon_gwd.png">
  <title>%nn;
    %if;(evar_m = "ADD_FAM" or evar_m = "ADD_FAM_OK")
      [*add::family/families]0%nn;
    %elseif;(evar_m = "ADD_PAR")[*add::parents]0%nn;
    %elseif;(evar_m = "MOD_FAM" or evar_m = "MOD_FAM_OK")
      [*modify::family/families]0 # %evar_i;
    %elseif;(evar_m = "MRG_DUP_FAM_Y_N" or evar_m = "MRG_FAM" or
             evar_m = "MRG_FAM_OK" or evar_m = "MRG_MOD_FAM_OK")
      [*merge::family/families]1 # %evar_i;
    %end;
  </title>
  %include.css;
  %base_header;
</head>
<body%body_prop;>
%message_to_wizard;
<div class="container">
%include_perso_header;

<script>
<!--
function changeCalendar(e,v,m,c) {
  var mv = m;
  switch (m) {
  case "VD": mv = 1; break;
  case "BR": mv = 2; break;
  case "FM": mv = 3; break;
  case "NI": mv = 4; break;
  case "PL": mv = 5; break;
  case "VT": mv = 6; break;
  case "GE": mv = 7; break;
  case "FL": mv = 8; break;
  case "PR": mv = 9; break;
  case "ME": mv = 10; break;
  case "TH": mv = 11; break;
  case "FT": mv = 12; break;
  case "JC": mv = 13; break;
  }
  switch(c.options%[c.selectedIndex%].value) {
  case 'G':
  case 'J':
    document.getElementById(e).innerHTML = '\
<select class="form-control" name="' + v + '">\
<option value=""' + (mv == 0 ? ' selected="selected"' : '') + '>%nn;
-</option>\
<option value="1"' + (mv == 1 ? ' selected="selected"' : '') + '>%nn;
[(month)]0</option>\
<option value="2"' + (mv == 2 ? ' selected="selected"' : '') + '>%nn;
[(month)]1</option>\
<option value="3"' + (mv == 3 ? ' selected="selected"' : '') + '>%nn;
[(month)]2</option>\
<option value="4"' + (mv == 4 ? ' selected="selected"' : '') + '>%nn;
[(month)]3</option>\
<option value="5"' + (mv == 5 ? ' selected="selected"' : '') + '>%nn;
[(month)]4</option>\
<option value="6"' + (mv == 6 ? ' selected="selected"' : '') + '>%nn;
[(month)]5</option>\
<option value="7"' + (mv == 7 ? ' selected="selected"' : '') + '>%nn;
[(month)]6</option>\
<option value="8"' + (mv == 8 ? ' selected="selected"' : '') + '>%nn;
[(month)]7</option>\
<option value="9"' + (mv == 9 ? ' selected="selected"' : '') + '>%nn;
[(month)]8</option>\
<option value="10"' + (mv == 10 ? ' selected="selected"' : '') + '>%nn;
[(month)]9</option>\
<option value="11"' + (mv == 11 ? ' selected="selected"' : '') + '>%nn;
[(month)]10</option>\
<option value="12"' + (mv == 12 ? ' selected="selected"' : '') + '>%nn;
[(month)]11</option>\
</select>\
';
    break;
  case 'F':
    document.getElementById(e).innerHTML = '\
<select class="form-control" name="' + v + '">\
<option value=""' + (mv == 0 ? ' selected="selected"' : '') + '>%nn;
-</option>\
<option value="1"' + (mv == 1 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]0</option>\
<option value="2"' + (mv == 2 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]1</option>\
<option value="3"' + (mv == 3 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]2</option>\
<option value="4"' + (mv == 4 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]3</option>\
<option value="5"' + (mv == 5 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]4</option>\
<option value="6"' + (mv == 6 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]5</option>\
<option value="7"' + (mv == 7 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]6</option>\
<option value="8"' + (mv == 8 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]7</option>\
<option value="9"' + (mv == 9 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]8</option>\
<option value="10"' + (mv == 10 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]9</option>\
<option value="11"' + (mv == 11 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]10</option>\
<option value="12"' + (mv == 12 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]11</option>\
<option value="13"' + (mv == 13 ? ' selected="selected"' : '') + '>%nn;
[(french revolution month)]12</option>\
</select>\
';
    break;
  case 'H':
    document.getElementById(e).innerHTML = '\
<select class="form-control" name="' + v + '">\
<option value=""' + (mv == 0 ? ' selected="selected"' : '') + '>%nn;
-</option>\
<option value="1"' + (mv == 1 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]0</option>\
<option value="2"' + (mv == 2 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]1</option>\
<option value="3"' + (mv == 3 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]2</option>\
<option value="4"' + (mv == 4 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]3</option>\
<option value="5"' + (mv == 5 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]4</option>\
<option value="6"' + (mv == 6 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]5</option>\
<option value="7"' + (mv == 7 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]6</option>\
<option value="8"' + (mv == 8 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]7</option>\
<option value="9"' + (mv == 9 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]8</option>\
<option value="10"' + (mv == 10 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]9</option>\
<option value="11"' + (mv == 11 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]10</option>\
<option value="12"' + (mv == 12 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]11</option>\
<option value="13"' + (mv == 13 ? ' selected="selected"' : '') + '>%nn;
[(hebrew month)]12</option>\
</select>\
';
    break;
  }
}
-->
</script>

<script>
  function show_fevent_label(xxname, xcnt) {
    var selector = document.getElementById('fevent_select' + xcnt);
    var label = document.getElementById('fevent_label_selector' + xcnt);
    var input = document.getElementById('e_name' + xcnt);
    if (selector.value == "") {
      if (xxname.charAt(0) == "#") {
        input.value = "";
      }
      else {
        input.value = xxname;
      }
    }
    else {
      input.value = selector.value;
    }
    if (selector.value == "" || selector.value.charAt(0) != "#") {
      label.style.display = 'inline';
    }
    else {
      label.style.display = 'none';
    }
  }

  $(document).ready(function(){
     //show evt perso
     $(".other_evts").each(function(){
       var inp = $(this).find("input").first();
       if(inp.val().charAt(0) != "#" && inp.val() != ""){
         $(this).show();
       }
     });
  });
</script>

%define;date(xlab,xvar,xdt,xcond)
  <div class="row form-inline">
    <div class="col-sm-2 col-form-label">
      xlab
    </div>
    <div class="col-sm-6">
        %if;([ !dates order]0 = "ddmmyy" or [ !dates order]0 = "ddmmyyyy" or [ !dates order]0 = "dmyyyy")
        <label>
          <input type="number" class="form-control" name="xvar_dd" size="1" min="1" max="31" value="%xdt.day;" xcond%/>
          [year/month/day]2
        </label>
        <label>
          <span id="xvar_mm_sel">
            <input type="number" class="form-control"  name="xvar_mm" size="1" min="1" max="12" value="%xdt.month;" xcond%/>
          </span>
          [year/month/day]1
        </label>
        <label>
          <input type="text" class="form-control"  name="xvar_yyyy" size="4" maxlength="6" value="%xdt.year;" xcond%/>
          [year/month/day]0
        </label>
      %elseif;([ !dates order]0 = "mmddyyyy")
        <label>
          <span id="xvar_mm_sel">
            <input type="number" class="form-control"  name="xvar_mm" size="1" min="1" max="12" value="%xdt.month;" xcond%/>
          </span>
          [year/month/day]1
        </label>
        <label>
          <input type="number" class="form-control"  name="xvar_dd" size="1" min="1" max="31" value="%xdt.day;" xcond%/>
          [year/month/day]2
        </label>
        <label>
          <input type="text" class="form-control"  name="xvar_yyyy" size="4" maxlength="6" value="%xdt.year;" xcond%/>
          [year/month/day]0
        </label>
      %else;
        <label>
          <input type="text" class="form-control"  name="xvar_yyyy" size="4" maxlength="6" value="%xdt.year;" xcond%/>
          [year/month/day]0
        </label>
        <label>
          <span id="xvar_mm_sel">
            <input type="number" class="form-control"  name="xvar_mm" size="1" min="1" max="12" value="%xdt.month;" xcond%/>
          </span>
          [year/month/day]1
        </label>
        <label>
          <input type="number" class="form-control"  name="xvar_dd" size="1" min="1" max="31" value="%xdt.day;" xcond%/>
          [year/month/day]2
        </label>
      %end;
    </div>
    <div class="col-sm-2">
    <label for="xvar_prec" class="sr-only col-form-label">[precision]0</label>
      <select class="form-control" name="xvar_prec" id="xvar_prec" xcond>
        <option value="-" %if;(xdt.prec = "") selected="selected"%end;>&nbsp;</option>
        <option value="sure" %if;(xdt.prec = "sure") selected="selected"%end;>[exact]0</option>
        <option value="about" %if;(xdt.prec = "about") selected="selected"%end;>[about (date)]0</option>
        <option value="maybe" %if;(xdt.prec = "maybe") selected="selected"%end;>[possibly (date)]0</option>
        <option value="before" %if;(xdt.prec = "before") selected="selected"%end;>[before (date)]0</option>
        <option value="after" %if;(xdt.prec = "after") selected="selected"%end;>[after (date)]0</option>
        <option value="oryear" %if;(xdt.prec = "oryear") selected="selected"%end;>...[or]...</option>
        <option value="yearint" %if;(xdt.prec = "yearint") selected="selected"%end;>...[between (date)]...</option>
      </select>
    </div>
    <label for="xvar_text" class="sr-only col-form-label">...[or] [text]0</label>
    <div class="col-sm-2">
      <input type="text" class="form-control" name="xvar_text" maxlength="100" value="%xdt.text;" id="xvar_text" placeholder="[or] [text]0" xcond%/>
    </div>
  </div>
  <div class="row form-inline">
    <div class="col-sm-2"></div>
    <div class="col-sm-6">
      %if;([ !dates order]0 = "ddmmyy" or [ !dates order]0 = "ddmmyyyy" or [ !dates order]0 = "dmyyyy")
        <label>
          <input type="number" class="form-control"  name="xvar_orday" size="2" min="1" max="31" value="%xdt.orday;" xcond%/>
          [year/month/day]2
        </label>
        <label>
          <span id="xvar_ormonth_sel">
            <input type="number" class="form-control"  name="xvar_ormonth" size="2" min="1" max="12" value="%xdt.ormonth;" xcond%/>
          </span>
          [year/month/day]1
        </label>
        <label>
          <input type="text" class="form-control"  name="xvar_oryear" size="4" maxlength="6" value="%xdt.oryear;" xcond%/>
          [year/month/day]0
        </label>
      %elseif;([ !dates order]0 = "mmddyyyy")
        <label>
          <span id="xvar_ormonth_sel">
            <input type="number" class="form-control"  name="xvar_ormonth" size="2" min="1" max="12" value="%xdt.ormonth;" xcond%/>
          </span>
          [year/month/day]1
        </label>
        <label>
          <input type="number" class="form-control"  name="xvar_orday" size="2" min="1" max="31" value="%xdt.orday;" xcond%/>
          [year/month/day]2
        </label>
        <label>
          <input type="text" class="form-control"  name="xvar_oryear" size="4" maxlength="6" value="%xdt.oryear;" xcond%/>
          [year/month/day]0
        </label>
      %else;
        <label>
          <input type="text" class="form-control"  name="xvar_oryear" size="4" maxlength="6" value="%xdt.oryear;" xcond%/>
          [year/month/day]0
        </label>
        <label>
          <span id="xvar_ormonth_sel">
            <input type="number" class="form-control"  name="xvar_ormonth" size="2" min="1" max="12" value="%xdt.ormonth;" xcond%/>
          </span>
          [year/month/day]1
        </label>
        <label>
          <input type="number" class="form-control"  name="xvar_orday" size="2" min="1" max="31" value="%xdt.orday;" xcond%/>
          [year/month/day]2
        </label>
      %end;
    </div>
    <div class="col-sm-2">
      <label for="xvar_cal" class="sr-only col-form-label">[calendar/calendars]0</label>
      <select class="form-control" nAme="xvar_cal" id="xvar_cal" onchange="changeCalendar('xvar_mm_sel','xvar_mm','%xdt.month;',this),%nn;
                                        changeCalendar('xvar_ormonth_sel','xvar_ormonth','%xdt.ormonth;',this)"xcond>
        <option value="G" %if;(xdt.calendar = "gregorian") selected="selected"%end;>
          [*gregorian/julian/french/hebrew]0
        </option>
        <option value="J" %if;(xdt.calendar = "julian") selected="selected"%end;>
          [*gregorian/julian/french/hebrew]1
        </option>
        <option value="F" %if;(xdt.calendar = "french") selected="selected"%end;>
          [*gregorian/julian/french/hebrew]2
        </option>
        <option value="H" %if;(xdt.calendar = "hebrew") selected="selected"%end;>
          [*gregorian/julian/french/hebrew]3
        </option>
      </select>
    </div>
  </div>
%end;

%define;source(xvar,xx)
  <div class="row">
    <label for="xvar_src" class="col-sm-1 col-form-label">[*source/sources]0</label>
    <div class="col-sm-11">
      <textarea class="form-control" name="xvar_src" id="xvar_src" rows="1">%xx_src;</textarea>
    </div>
  </div>
%end;

%define;note(xvar,xx)
  <div class="row">
    <label for="xvar_note" class="col-sm-1 col-form-label">[*note/notes]0</label>
    <div class="col-sm-11">
      <textarea class="form-control" name="xvar_note" id="xvar_note" rows="1">%xx_note;</textarea>
    </div>
  </div>
%end;

%define;small_date(kind,xvar,xx,verbose)
  <div class="row">
    <p class="col-sm-2 col-form-label">[*kind]</p>
    <div class="col-sm-%if;(verbose=true)3%else;5%end; form-inline">
    %if;([ !dates order]0 = "ddmmyy" or [ !dates order]0 = "ddmmyyyy" or [ !dates order]0 = "dmyyyy")
      <label for="xvar_dd" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]2</label>
      <input type="number" class="form-control" name="xvar_dd" id="xvar_dd" min="1" max="31" value="%xx.create.kind_day;" placeholder="[dd/mm/yyyy]0">
      <label for="xvar_mm" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]1</label>
      <input type="number" class="form-control" name="xvar_mm" id="xvar_mm" min="1" max="12" value="%xx.create.kind_month;" placeholder="[dd/mm/yyyy]1">
      <label for="xvar=yyyy" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]0</label>
      <input type="text" class="form-control" name="xvar_yyyy" id="xvar_yyyy" size="3" maxlength="6" value="%xx.create.kind_year;" placeholder="[dd/mm/yyyy]2">
    %elseif;([ !dates order]0 = "mmddyyyy")
      <label for="xvar_mm" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]1</label>
      <input type="number" class="form-control" name="xvar_mm" id="xvar_mm" min="1" max="12" value="%xx.create.kind_month;" placeholder="[dd/mm/yyyy]1">
      <label for="xvar_dd" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]2</label>
      <input type="number" class="form-control" name="xvar_dd" id="xvar_dd" min="1" max="31" value="%xx.create.kind_day;" placeholder="[dd/mm/yyyy]0">
      <label for="xvar=yyyy" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]0</label>
      <input type="text" class="form-control" name="xvar_yyyy" id="xvar_yyyy" size="3" maxlength="6" value="%xx.create.kind_year;" placeholder="[dd/mm/yyyy]2">
    %else;
      <label for="xvar=yyyy" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]0</label>
      <input type="text" class="form-control" name="xvar_yyyy" id="xvar_yyyy" size="3" maxlength="6" value="%xx.create.kind_year;" placeholder="[dd/mm/yyyy]2">
      <label for="xvar_mm" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]1</label>
      <input type="number" class="form-control" name="xvar_mm" id="xvar_mm" min="1" max="12" value="%xx.create.kind_month;" placeholder="[dd/mm/yyyy]1">
      <label for="xvar_dd" class="col-form-label %if;(verbose=true)sr-only%end;">[year/month/day]2</label>
      <input type="number" class="form-control" name="xvar_dd" id="xvar_dd" min="1" max="31" value="%xx.create.kind_day;" placeholder="[dd/mm/yyyy]0">
    %end;
    </div>
    <label for="xvar_pl" class="%if;(verbose=true)sr-only%end; col-sm-1 col-form-label">[place]</label>%nn;
    <div class="col-sm-3">
      <input type="text" class="form-control" name="xvar_pl" value="%xx.create.kind_place;" id="xvar_pl" placeholder="[place]">
    </div>
  </div>
%end;

%define;birth(xvar,xx,verbose)
  %apply;small_date("birth","xvarb","xx","verbose")
%end;

%define;death(xvar,xx,verbose)
  %apply;small_date("death","xvard","xx","verbose")
%end;


%define;parent(xcnt,xx)
  <div class="row">
     %if;(bvar.multi_parents != "yes")<h5 class="col-form-label col-sm-2">%parent.himher;</h5>
       <div class="col-sm-2">
       <select class="form-control" name="paxcnt_p">
         <option value="create" %if;(xx.create = "create") selected="selected"%end;>[*create]0</option>
         <option value="link" %if;(xx.create = "link") selected="selected"%end;>[*link]0</option>
       </select>
     </div>
     %end;
  </div>
  <div class="row">
     <label for="paxcnt_fn" class="col-sm-2 col-form-label">[*first name/first names]0</label>
     <div class="col-sm-6">
       <input class="form-control" type="text" name="paxcnt_fn" value="%xx.first_name;" id="paxcnt_fn" placeholder="[*first name/first names]0">
     </div>
     <label for="paxcnt_occ" class="col-sm-1 col-form-label">[*number]</label>
     <div class="col-sm-1">
        <input class="form-control" type="text" name="paxcnt_occ" size="5" maxlength="8" value="%xx.occ;" id="paxcnt_occ" placeholder="#">
     </div>
     %if;(bvar.multi_parents = "yes")
       <div class="col-sm-2 offset-sm-2">
       <select class="form-control" name="paxcnt_p">
         <option value="create" %if;(xx.create = "create") selected="selected"%end;>[*create]0</option>
         <option value="link" %if;(xx.create = "link") selected="selected"%end;>[*link]0</option>
       </select>
     </div>
     %end;
  </div>
  <div class="row">
    <label for="paxcnt_sn" class="col-sm-2 col-form-label">[*surname/surnames]0</label>
    <div class="col-sm-6">
      <input class="form-control" type="text" name="paxcnt_sn" value="%xx.surname" id="paxcnt_sn" placeholder="[*surname/surnames]0">
    </div>
  </div>
      %apply;birth("paxcnt","xx","true")
      %apply;death("paxcnt","xx","true")
  <div class="row">
    <label for="paxcnt_occupation" class="col-sm-2 col-form-label">[*occupation/occupations]0</label>
    <div class="col-sm-6">
      <textarea class="form-control" name="paxcnt_occupation" id="paxcnt_occupation" rows="1" placeholder="[*occupation/occupations]0">%xx.create.occupation</textarea>
    </div>
  </div>
%end;

%define;insert_parent(xcnt)
  <div class="row form-group">
    <label for="ins_paxcnt_n" class="col-form-label col-sm-1">[*insert]</label>
    <div class="col-sm-1">
      <input type="number" class="form-control" name="ins_eventxcnt_n" value="1" id="ins_paxcnt_n">
    </div>
    <div class="btn-group" role="group">
      <div class="btn-group" data-toggle="buttons">
        <label class="btn btn-secondary"> [parents]0(s)
          <input type="checkbox" name="ins_paxcnt" value="on">
        </label>
      </div>
      <button type="submit" class="btn btn-secondary" title="[*insert::parents]0(s)">OK</button>
    </div>
  </div>
%end;

%define;selector_fevent(xcnt)
  <select class="form-control custom-select font-weight-bold" id="fevent_selectxcnt" onchange="show_fevent_label($('#e_namexcnt').prop('defaultValue'), 'xcnt')">
    <option value="">-</option>
    <option value="#marr" %if;(event.e_name = "#marr" or event.e_name="") selected="selected" %end;>[*marriage event]</option>
    <option value="#nmar" %if;(event.e_name = "#nmar") selected="selected"%end;>[*no marriage event]</option>
    <option value="#enga" %if;(event.e_name = "#enga") selected="selected"%end;>[*engage event]</option>
    <option value="#nmen" %if;(event.e_name = "#nmen") selected="selected"%end;>[*no mention]</option>
    <option value="#marb" %if;(event.e_name = "#marb") selected="selected"%end;>[*marriage bann]</option>
    <option value="#marc" %if;(event.e_name = "#marc") selected="selected"%end;>[*marriage contract]</option>
    <option value="#marl" %if;(event.e_name = "#marl") selected="selected"%end;>[*marriage licence]</option>
    <option value="#pacs" %if;(event.e_name = "#pacs") selected="selected"%end;>[*PACS]</option>
    <option value="#div"  %if;(event.e_name = "#div")  selected="selected"%end;>[*divorce event]</option>
    <option value="#sep"  %if;(event.e_name = "#sep")  selected="selected"%end;>[*separate event]</option>
    <option value="#anul" %if;(event.e_name = "#anul") selected="selected"%end;>[*annulation]</option>
    <option value="#resi" %if;(event.e_name = "#resi") selected="selected"%end;>[*residence]</option>
  </select>
%end;

%define;insert_fevent(xcnt)
  <div class="row form-group">
    <label for="ins_eventxcnt_n" class="col-form-label col-sm-1">[*insert]</label>
    <div class="col-sm-1">
      <input type="number" class="form-control" name="ins_eventxcnt_n" value="1" id="ins_eventxcnt_n">
    </div>
    <div class="btn-group" role="group">
      <div class="btn-group" data-toggle="buttons">
        <label class="btn btn-secondary"> [event/events]0(s)
          <input type="checkbox" name="ins_eventxcnt" value="on">
        </label>
      </div>
      <button type="submit" class="btn btn-secondary" title="[*insert::event/events]0(s)">OK</button>
    </div>
  </div>
%end;

%define;insert_witness(xcnt, wcnt)
  <div class="row form-group">
    <label for="excnt_ins_witnwcnt_n" class="col-form-label col-sm-1">[*insert]</label>
    <div class="col-sm-1">
      <input type="number" class="form-control" name="excnt_ins_witnwcnt_n" value="1" min="1" id="excnt_ins_witnwcnt">
    </div>
    <div class="btn-group" role="group">
      <div class="btn-group" data-toggle="buttons">
        <label class="btn btn-secondary"> [witness/witness/witnesses]0(s)
          <input type="checkbox" name="excnt_ins_witnwcnt" value="on">
        </label>
      </div>
      <button type="submit" class="btn btn-secondary" title="[*insert::witness/witness/witnesses]0(s)">OK</button>
    </div>
  </div>
%end;

%define;one_witness(xcnt, wcnt)
  <div class="row">
    <h5 class="col-form-label col-sm-2">[*witness/witness/witnesses]0 wcnt </h5>
     <div class="col-sm-2">
       <select class="form-control" name="excnt_witnwcnt_p">
        <option value="link"%if;(fwitness.create = "link") selected="selected"%end;>[*link]0</option>
        <option value="create"%if;(fwitness.create = "create") selected="selected"%end;>[*create]0</option>
      </select>
    </div>
    <div class="col-sm-3">
      <select class="form-control" name="excnt_witnwcnt_kind">
        <option value="godp" %if;(fwitness_kind = "godp") selected="selected" %end;>[*godfather/godmother/godparents]2</option>
        <option value="offi" %if;(fwitness_kind = "offi") selected="selected" %end;>[*officer/officer/officers]0</option>
        <option value=""     %if;(fwitness_kind = "")     selected="selected" %end;>[*witness/witness/witnesses]0</option>
      </select>
    </div>
  </div>
  <div class="row">
    <label for="excnt_witnwcnt_fn" class="col-sm-2 col-form-label">[*first name/first names]0</label>
    <div class="col-sm-5">
      <input type="text" class="form-control" name="excnt_witnwcnt_fn" value="%fwitness.first_name;" id="excnt_witnwcnt_fn" placeholder="[*first name/first names]0">
    </div>
    <label for="excnt_witnwcnt_occ" class="col-sm-1 col-form-label">[*number]0</label>
    <div class="col-sm-1">
      <input type="number" class="form-control" name="excnt_witnwcnt_occ" size="4" min="0" value="%fwitness.occ;" id="excnt_witnwcnt_occ">
    </div>
  </div>
  <div class="row">
    <label for="excnt_witnwcnt_sn" class="col-sm-2 col-form-label">[*surname/surnames]0</label>
    <div class="col-sm-5">
      <input type="text" class="form-control" name="excnt_witnwcnt_sn" maxlength="200" value="%fwitness.surname;" id="excnt_witnwcnt_sn" placeholder="[*surname/surnames]0">
    </div>
    <label class="col-sm-1">[*sex]</label>
    <div class="col-sm-2">
      <div class="radio-inline">
        <label>
          <input type="radio" name="excnt_witnwcnt_sex" value="M" %if;(witness.create.sex = "male") checked="checked"%end;%/>[M/F]0
        </label>
        <label>
          <input type="radio" name="excnt_witnwcnt_sex" value="N" %if;(witness.create.sex = "neuter") checked="checked"%end;%/>?
        </label>
        <label>
          <input type="radio" name="excnt_witnwcnt_sex" value="F" %if;(witness.create.sex = "female") checked="checked"%end;%/>[M/F]1
        </label>
      </div>
    </div>
  </div>
%end;

%define;one_fevent(xcnt)
  <div class="row">
    <label for="e_namexcnt" class="col-sm-2 col-form-label">[*event/events]0</label>
    <div class="col-sm-3">
      %apply;selector_fevent(xcnt)
    </div>
    <label id="fevent_label_selectorxcnt" class="other_evts sr-only">
      [or]0 [text]0</label>
    <div class="col-sm-6">
      <input class="form-control" type="text" name="e_namexcnt" value="%if;(event.e_name = "")#marr%else;%event.e_name;%end;" id="e_namexcnt" placeholder="[*custom] [event/events]0">
    </div>
  </div>
  <div class="row">
    <label for="e_placexcnt" class="col-sm-2 col-form-label">[*place]</label>
    <div class="col-sm-5">
      <input class="form-control" type="text" name="e_placexcnt" size="40" maxlength="200" value="%event.e_place;" id="e_placexcnt">
    </div>
  </div>
  %apply;date([*date/dates]0, "e_datexcnt", "event_date", "")
  <div class="row">
    <label for="e_notexcnt" class="col-sm-2 col-form-label">[*note/notes]0</label>
    <div class="col-sm-10">
      <textarea class="form-control" name="e_notexcnt" rows="1" id="e_notexcnt">%event.e_note;</textarea>
    </div>
  </div>
  <div class="row">
    <label for="e_srcxcnt" class="clearfix col-sm-2 col-form-label">[*source/sources]0</label>
    <div class="col-sm-10">
      <textarea class="form-control" name="e_srcxcnt" rows="1" id="e_srcxcnt">%event.e_src;</textarea>
    </div>
  </div>
  <div class="row mt-1 offset-sm-1">
  %if;has_fwitness;
    %foreach;fwitness;
      %apply;one_witness(xcnt, wcnt)
      %if;is_last;%apply;insert_witness(xcnt, wcnt)%end;
    %end;
  %else;
    %apply;insert_witness(xcnt, "0")
  %end;
  </div>
  <hr>
%end

%define;card_header(xx)
  <h3 class="card-header"><label for="xx_"><a id="xx_">[*xx]1</a></label></h3>
%end;

<h1>%nn;
  %if;(evar_m = "ADD_FAM" or evar_m = "ADD_FAM_OK")
    [*add::family/families]0
  %elseif;(evar_m = "ADD_PAR")
    [*add::parents]
  %elseif;(evar_m = "MOD_FAM" or evar_m = "MOD_FAM_OK")
    [*modify::family/families]0 # %evar_i;
  %elseif;(evar_m = "MRG_DUP_FAM_Y_N" or evar_m = "MRG_FAM" or
           evar_m = "MRG_FAM_OK" or evar_m = "MRG_MOD_FAM_OK")
    [*merge::family/families]1 # %evar_i;
  %end;
</h1>

<form method="post" action="%action;">
  <p>
    %hidden;
    <input type="hidden" name="digest" value="%digest;"%/>
    %if;(evar_ip != "")<input type="hidden" name="ip" value="%evar_ip;"%/>%nl;%end;
    %if;(evar_i != "")<input type="hidden" name="i" value="%evar_i;"%/>%nl;%end;
    %if;(evar_m = "ADD_FAM" or evar_m = "ADD_FAM_OK")
      <input type="hidden" name="m" value="ADD_FAM_OK"%/>%nl;
    %elseif;(evar_m = "ADD_PAR")
      <input type="hidden" name="m" value="ADD_FAM_OK"%/>%nl;
    %elseif;(evar_m = "MOD_FAM" or evar_m = "MOD_FAM_OK")
      <input type="hidden" name="m" value="MOD_FAM_OK"%/>%nl;
    %elseif;(evar_m = "MRG_DUP_FAM_Y_N" or evar_m = "MRG_FAM" or
             evar_m = "MRG_FAM_OK" or evar_m = "MRG_MOD_FAM_OK")
      <input type="hidden" name="i2" value="%evar_i2;"%/>
      %if;(evar_ini1 != "" and evar_ini2 != "")
        <input type="hidden" name="ini1" value="%evar_ini1;"%/>
        <input type="hidden" name="ini2" value="%evar_ini2;"%/>
      %end;
      %if;(evar.iexcl != "")
        <input type="hidden" name="iexcl" value="%evar.iexcl;"%/>
      %end;
      %if;(evar.fexcl != "")
        <input type="hidden" name="fexcl" value="%evar.fexcl;"%/>
      %end;
      <input type="hidden" name="m" value="MRG_MOD_FAM_OK"%/>%nl;
    %end;
  </p>

  <div class="card">
    %apply;card_header("parents")
    <div class="card-block">
      %foreach;parent;
        %apply;parent(cnt, "parent")
        %if;(cnt=1)<hr>%end;
        %if;(bvar.multi_parents = "yes")%apply;insert_parent(cnt)%end;
      %end;
    </div>
  </div>

  <div class="card">
    %apply;card_header("event/events")
    <div class="card-block">
  <div style="display:none;">
    <p>
      <label>
        <input type="radio" name="mrel" value="marr" %if;(mrel = "marr" or mrel = "nsckm") checked="checked"%end;%/>[*married]
      </label>
      <label>
        <input type="radio" name="mrel" value="not_marr" %if;(mrel = "not_marr" or mrel = "nsck") checked="checked"%end;%/>[*not married]
      </label>
      <label>
        <input type="radio" name="mrel" value="engaged"%if;(mrel = "engaged")checked="checked"%end;%/>[*engaged]
      </label>
      %( Déplacé dans les fevents
      <label>
        <input type="checkbox" name="nsck" value="on "%if;(mrel = "nsck" or mrel = "nsckm") checked="checked"%end;%/>[*no sexes check]<br%/>
      </label>
      %)
      <label>
        <input type="radio" name="mrel" value="no_ment"%if;(mrel = "no_ment")checked="checked"%end;%/>[*no mention]
      </label>
    </p>
    <table style="border-width:1;width:700;">
      <tr>
        <td><label for="marr_place">[*place]</label></td>
        <td>
          <input type="text" name="marr_place" size="40" maxlength="200" value="%marriage_place;" id="marr_place"%/>
        </td>
      </tr>
    </table>

    %apply;date([*date/dates]0, "marr", "marriage", "")
    %apply;note("marr", "marriage")
    %apply;source("marr", "marriage")

    <h4>[*witness/witness/witnesses]2</h4>

    <table style="border-width:1">
      <tr>
        <td>
          <label>[*insert::witness/witness/witnesses]0
          <input type="checkbox" name="ins_witn0" value="on"%/></label>
        </td>
      </tr>
    </table>

    %foreach;witness;
      <table style="border-width:1;width:700">
        <tr>
          <td><label for="witn%cnt;_fn">[*first name/first names]0</label></td>
          <td>
            <input type="text" name="witn%cnt;_fn" size="40" maxlength="200" value="%witness.first_name;" id="witn%cnt;_fn"%/>
          </td>
          <td style="text-align:%right;"><label for="witn%cnt;_occ">[*number]</label></td>
          <td>
            <input type="text" name="witn%cnt;_occ" size="5" maxlength="8" value="%witness.occ;" id="witn%cnt;_occ"%/>
          </td>
          <td>
            <select name="witn%cnt;_p">
              <option value="link"%if;(witness.create = "link") selected="selected"%end;>[*link]0</option>
              <option value="create"%if;(witness.create = "create") selected="selected"%end;>[*create]0</option>
            </select>
          </td>
        </tr>
        <tr>
          <td><label for="witn%cnt;_sn">[*surname/surnames]0</label></td>
          <td colspan="3">
            <input type="text" name="witn%cnt;_sn" size="40" maxlength="200" value="%witness.surname;" id="witn%cnt;_sn"%/>
          </td>
          <td>
            <label>
              <input type="radio" name="witn%cnt;_sex" value="N" %if;(witness.create.sex = "neuter") checked="checked"%end;%/>?
            </label>
            <label>
              <input type="radio" name="witn%cnt;_sex" value="M" %if;(witness.create.sex = "male") checked="checked"%end;%/>[M/F]0
            </label>
            <label>
              <input type="radio" name="witn%cnt;_sex" value="F" %if;(witness.create.sex = "female") checked="checked"%end;%/>[M/F]1
            </label>
          </td>
        </tr>
      </table>
      <table style="border-width:1">
        <tr>
          <td>
            <label>
              [*insert::witness/witness/witnesses]0
              <input type="checkbox" name="ins_witn%cnt;" value="on"%/>
            </label>
          </td>
        </tr>
      </table>
    %end;

    <h4>[*divorce] </h4>
    <p>
      <label>
        <input type="radio" name="div" value="not_divorced" %if;(divorce = "not_divorced") checked="checked"%end;%/>[*not divorced]
      </label>
      <label>
        <input type="radio" name="div" value="divorced" %if;(divorce = "divorced") checked="checked"%end;%/>[*divorced]
      </label>
      <label>
        <input type="radio" name="div" value="separated" %if;(divorce = "separated") checked="checked"%end;%/>[*separated]
      </label>
    </p>
    %apply;date([*date/dates]0, "div", "divorce", "")
  </div>

      <input type="checkbox" name="nsck" value="on "%if;(mrel = "nsck" or mrel = "nsckm") checked="checked"%end;%/>[*no sexes check]
      %if;has_fevents;
        %foreach;fevent;
          %apply;one_fevent(cnt)
          %if;is_last;
            %apply;insert_fevent(cnt)
          %end;
        %end;
      %else;
        %apply;one_fevent("1")
        %apply;insert_fevent("1")
      %end;
    </div>
  </div>

%define;insert_child(xcnt)
  <label for="ins_chxcnt_n" class="col-form-label col-sm-1 offset-sm-3">[*insert] <span class="fa fa-plus"></span></label>
  <div class="col-sm-1">
    <input type="number" class="form-control" name="ins_chxcnt_n" value="1" min="1" id="ins_chxcnt_n">
  </div>
  <div class="col-sm-3">
    <div class="btn-group" role="group">
      <div class="btn-group" data-toggle="buttons">
        <label class="btn btn-secondary" title="[*insert::child/children]0/[child/children]1"> [child/children]0/[child/children]1
          <input type="checkbox" name="ins_chxcnt" value="on">
        </label>
      </div>
      <button type="submit" class="btn btn-secondary">OK</button>
    </div>
  </div>
%end;

%define;invert_children(xcnt)
  <div class="col-sm-3 pull-sm-8">
    <div class="btn-group" role="group">
      <div class="btn-group" data-toggle="buttons">
         <label class="btn btn-secondary" title="[*invert] [child/children]0 %expr(xcnt-1) [and] xcnt"><span class="fa fa-user-o"></span> %expr(xcnt-1) <span class="fa fa-exchange"></span> <span class="fa fa-user-o"></span> xcnt
          <input type="checkbox" name="inv_chxcnt" value="on">
        </label>
      </div>
      <button type="submit" class="btn btn-secondary">OK</button>
    </div>
  </div>
%end;

%define;child(xcnt)
  <div class="row">
    <hr>
    <h5 class="col-form-label col-sm-2">[*child/children]0 %cnt;</h5>
    <div class="col-sm-2">
      <select class="form-control" name="chxcnt_p">
        <option value="link"%if;(child.create = "link") selected="selected"%end;>[*link]0</option>
        <option value="create"%if;(child.create = "create") selected="selected"%end;>[*create]0</option>
      </select>
    </div>
  </div>
  <div class="row">
    <label for="chxcnt_fn" class="col-sm-2 col-form-label">[*first name/first names]0</label>
    <div class="col-sm-6">
        <input class="form-control" type="text" name="chxcnt_fn" value="%child.first_name;" id="chxcnt_fn">
    </div>
    <label for="chxcnt_occ" class="col-sm-1 col-form-label">[*number]</label>
    <div class="col-sm-1">
      <input class="form-control" type="text" name="chxcnt_occ" maxlength="4" value="%child.occ;" id="chxcnt_occ">
    </div>
  </div>
  <div class="row">
    <label for="chxcnt_sn" class="col-sm-2 col-form-label">[*surname/surnames]0</label>
    <div class="col-sm-6">
      <input class="form-control" type="text" name="chxcnt_sn" 
         value="%nn;
           %if;
             ((evar_m = "ADD_FAM_OK" or
               evar_m = "MOD_FAM" or evar_m = "MOD_FAM_OK" or
               evar_m = "MRG_FAM_OK" or evar_m = "MRG_MOD_FAM_OK") and
              child.surname = father.surname)
           %else;%child.surname;%end;" id="chxcnt_sn">
    </div>
    <label for="chxcnt_sex" class="col-sm-1 col-form-label">[*sex]</label>
      <div class="col-sm-3">
        <div class="form-check-inline">
        <label class="form-check-inline">
          <input class="form-check-input" type="radio" name="chxcnt_sex" value="M" %if;(child.create.sex = "male") checked="checked"%end;%/> [M/F]0
        </label>
        <label class="form-check-inline">
          <input class="form-check-input" type="radio" name="chxcnt_sex" value="N" %if;(child.create.sex = "neuter") checked="checked"%end;%/> ?
        </label>
        <label class="form-check-inline">
          <input class="form-check-input" type="radio" name="chxcnt_sex" value="F" %if;(child.create.sex = "female") checked="checked"%end;%/> [M/F]1
        </label>
        </div>
      </div>
  </div>
  %apply;birth("chxcnt", "child", "true")
  %apply;death("chxcnt", "child", "true")
  <div class="row">
    <label for="chxcnt_occupation" class="col-sm-2 col-form-label">[*occupation/occupations]0</label>
    <div class="col-sm-6">
       <input class="form-control" type="text" name="chxcnt_occupation" value="%child.create.occupation;" id="chxcnt_occupation" placeholder="[*occupation/occupations]0">
    </div>
  </div>
%end;

  <div class="card">
    %apply;card_header("child/children")
    <div class="card-block">
      <div class="row">
        %apply;insert_child("0")
        %foreach;child;
          %if;(cnt != 1)
            %apply;invert_children(cnt)
          %end;
          <div class="col-sm-1 float-right">
            <button type="submit" class="btn btn-secondary">OK</button>
          </div>
          </div>
          %apply;child(cnt)
          <div class="row">
            <hr>
            %apply;insert_child(cnt)
        %end;
        <div class="col-sm-1 float-right">
          <button type="submit" class="btn btn-secondary">OK</button>
        </div>
      </div>
    </div>
  </div>

  <div class="card">
    %apply;card_header("comment")
    <div class="card-block">
      <textarea class="form-control" name="comment" id="comment" rows="4">%comment;</textarea>
    </div>
  </div>
  
  <div class="card">
    %apply;card_header("source/sources")
    <div class="card-block">
      <div class="row">
        <label for="psrc" class="col-sm-1 col-form-label">[[*person/persons]1]</label>
        <div class="col-sm-11">
          <textarea class="form-control" rows="1" name="psrc" id="psrc" placeholder="[*source/sources]1 [person/persons]1">
            %if;(evar_psrc != "")%evar_psrc;%else;%evar_dsrc;%end;
          </textarea>
        </div>
      </div>
      <div class="row">
        <label for="src" class="col-sm-1 col-form-label">[*family/families]0</label>
        <div class="col-sm-10">
          <textarea class="form-control" name="src" rows="1" id="src" placeholder="[*source/sources]1 [family/families]0">%fsources;</textarea>
        </div>
        <div class="col-sm-1">
          <label class="form-check-label">
            <input type="checkbox" name="rdsrc" value="on" %if;(evar_rdsrc = "on") checked="checked"%end;%/>
          </label>
        </div>
      </div>
    </div>
  </div>

  %if;(bvar.origin_file = "on")
    <input type="text" name="origin_file" size="50" maxlength="200" value="%origin_file;"%/>
  %end;

  <p>
    <input type="submit" value="Ok"%/>
  </p>
</form>

%base_trailer;
%include.copyr;
</div>
%include.js;
</body>
</html>