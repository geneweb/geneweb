<!DOCTYPE html>
<html lang="%lang;">
<head>
  <!-- $Id: updind.txt,v 7 10/11/2016 09:44:53 $ -->
  <!-- Copyright (c) 1998-2017 INRIA -->
  <title>%nn;
    %if;(evar_m = "MRG_IND_OK" or evar_m = "MRG_MOD_IND_OK")
      [*merge::person/persons]1 # %index;
    %elseif;(evar_m = "MOD_IND" or evar_m = "MOD_IND_OK")
      [*modify::person/persons]0 # %index;
    %else;[*add::person/persons]0%end;
  </title>
  <meta name="robots" content="none">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="%image_prefix;/favicon_gwd.png">

  %include.css;
  %base_header;
</head>
<body%body_prop; id="person">
<div class="container">
%message_to_wizard;
%include_perso_header;

%define;nav()
  <div class="container fixed-top" role="navigation">
    <nav class="navbar navbar-light bg-white justify-content-center py-0" id="banner">
      <nav class="nav nav-pills nav-fill">    
        <a class="nav-item nav-link" href="#person" title="[*person/persons]0"><i class="fa fa-user fa-fw" aria-hidden="true"></i><span class="d-none d-lg-inline-flex ml-1">[*person/persons]0</span></a>
        <a class="nav-item nav-link" href="#birth" title="[*birth]"><i class="far fa-circle fa-fw" aria-hidden="true"></i><span class="d-none d-md-inline-flex ml-1">[*birth]</span></a>
        <a class="nav-item nav-link" href="#baptism" title="[*baptism]"><i class="fa fa-child fa-fw" aria-hidden="true"></i><span class="d-none d-md-inline-flex ml-1">[*baptism]</span></a>
        <a class="nav-item nav-link" href="#death" title="[*death]"><i class="fa fa-plus fa-fw" aria-hidden="true"></i><span class="d-none d-md-inline-flex ml-1">[*death]</span></a>
        <a class="nav-item nav-link" href="#burial" title="[*burial]"><i class="fa fa-child fa-rotate-270 fa-fw" aria-hidden="true"></i><span class="d-none d-md-inline-flex ml-1">[*burial]</span></a>
        <a class="nav-item nav-link" href="#events" title="[*event/events]1"><i class="fa fa-graduation-cap fa-fw" aria-hidden="true"></i><span class="d-none d-lg-inline-flex ml-1">[*event/events]1</span></a>
        <a class="nav-item nav-link" href="#relations" title="[*relation/relations]1"><i class="fa fa-users fa-fw" aria-hidden="true"></i><span class="d-none d-lg-inline-flex ml-1">[*relation/relations]1</span></a>
        <a class="nav-item nav-link" href="#titles" title="[*title/titles]1"><i class="fa fa-star fa-fw" aria-hidden="true"></i><span class="d-none d-lg-inline-flex ml-1">[*title/titles]1</span></a>
        <a class="nav-item nav-link" href="#notes" title="[*note/notes]1"><i class="fa fa-file-alt fa-fw" aria-hidden="true"></i><span class="d-none d-lg-inline-flex ml-1">[*note/notes]1</span></a>
      </nav>
    </nav>
  </div>
%end;

%define;card_header(xx,yy)
  <div class="anchor_upd" id="xx"> </div>
  <h3 class="card-header pt-2 pb-1 text-center"><label for="xx">[*yy]1</label></h3>
%end;

%define;date(xlab,xvar,xdt,xcond)
  %let;day_input;pattern="(?:0?[1-9]|1[0-9]|2[0-9]|3[0-1])" size="1" maxlength="2" xcond%in;
  %let;month_input;pattern="(?:0?[1-9]|1[0-2]|VD|BR|FM|NI|PL|VT|GE|FL|PR|ME|TH|FT|JC|vd|br|fm|ni|pl|vt|ge|fl|pr|me|th|ft|jc)" size="1" maxlength="2" xcond%in;
  %let;year_input;pattern="[?><~/]?-?\d*/?" size="4" maxlength="8" xcond%in;
  <div class="row justify-content-sm-between justify-content-md-start">
    <div class="col-sm-1 col-md-2 col-form-label">
      xlab
    </div>
    <div class="col col-sm-auto form-inline">
      %if;([ !dates order]0 = "ddmmyy" or [ !dates order]0 = "ddmmyyyy" or [ !dates order]0 = "dmyyyy")
        <label>
          <input type="text" class="form-control" name="xvar_dd" value="%xdt.day;" %day_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]2</span>
        </label>
        <label>
          <span id="xvar_mm_sel">
            <input type="text" class="form-control ml-sm-2 ml-md-3" name="xvar_mm" value="%xdt.month;" %month_input;%/>
          </span>
          <span class="ml-sm-1 ml-md-2">[year/month/day]1</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-2 ml-md-3" name="xvar_yyyy" value="%xdt.year;" %year_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]0</span>
        </label>
      %elseif;([ !dates order]0 = "mmddyyyy")
        <label>
          <span id="xvar_mm_sel">
            <input type="text" class="form-control" name="xvar_mm" value="%xdt.month;" %month_input;%/>
          </span>
          <span class="ml-sm-1 ml-md-2">[year/month/day]1</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-2 ml-md-3" name="xvar_dd" value="%xdt.day;" %day_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]2</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-2 ml-md-3" name="xvar_yyyy" value="%xdt.year;" %year_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]0</span>
        </label>
      %else;
        <label>
          <input type="text" class="form-control" name="xvar_yyyy" value="%xdt.year;" %year_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]0</span>
        </label>
        <label>
          <span id="xvar_mm_sel">
            <input type="text" class="form-control ml-sm-2 ml-md-3" name="xvar_mm" value="%xdt.month;" %month_input;%/>
          </span>
          <span class="ml-sm-1 ml-md-2">[year/month/day]1</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-2 ml-md-3" name="xvar_dd" value="%xdt.day;" %day_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]2</span>
        </label>
      %end;
    </div>
    <div class="col-10 col-lg ml-auto form-inline">
      <label for="xvar_prec" class="sr-only col-form-label">[precision]0</label>
      <select class="form-control pl-lg-1 pr-lg-0 px-xl-2" name="xvar_prec" id="xvar_prec" xcond>
        %(<option value="-" %if;(xdt.prec = "") selected%end;>&nbsp;</option>%)
        <option value="sure" %if;(xdt.prec = "sure") selected%end;>[exact]0</option>
        <option value="about" %if;(xdt.prec = "about") selected%end;>[about (date)]0</option>
        <option value="maybe" %if;(xdt.prec = "maybe") selected%end;>[possibly (date)]0</option>
        <option value="before" %if;(xdt.prec = "before") selected%end;>[before (date)]0</option>
        <option value="after" %if;(xdt.prec = "after") selected%end;>[after (date)]0</option>
        <option value="oryear" %if;(xdt.prec = "oryear") selected%end;>…[or]…</option>
        <option value="yearint" %if;(xdt.prec = "yearint") selected%end;>…[between (date)]…</option>
      </select>
      <label for="xvar_cal" class="sr-only col-form-label">[calendar/calendars]0</label>
      <select class="form-control pl-lg-1 pr-lg-0 px-xl-2 ml-sm-1 ml-md-3" name="xvar_cal" id="xvar_cal" onchange="changeCalendar('xvar_mm_sel','xvar_mm','%xdt.month;',this),%nn;
                                        changeCalendar('xvar_ormonth_sel','xvar_ormonth','%xdt.ormonth;',this)" xcond>
        <option value="" %if;(xdt.calendar = "") selected%end;>
          -
        </option>
        <option value="G" %if;(xdt.calendar = "gregorian") selected%end;>
          [*gregorian/julian/french/hebrew]0
        </option>
        <option value="J" %if;(xdt.calendar = "julian") selected%end;>
          [*gregorian/julian/french/hebrew]1
        </option>
        <option value="F" %if;(xdt.calendar = "french") selected%end;>
          [*gregorian/julian/french/hebrew]2
        </option>
        <option value="H" %if;(xdt.calendar = "hebrew") selected%end;>
          [*gregorian/julian/french/hebrew]3
        </option>
      </select>
    </div>
  </div>
  <div class="row justify-content-sm-end justify-content-md-start">
    <div class="col-sm-1 col-md-2"></div>
    <div class="col col-sm-auto form-inline">
      %if;([ !dates order]0 = "ddmmyy" or [ !dates order]0 = "ddmmyyyy" or [ !dates order]0 = "dmyyyy")
        <label>
          <input type="text" class="form-control" name="xvar_orday" value="%xdt.orday;" %day_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]2</span>
        </label>
        <label>
          <span id="xvar_ormonth_sel">
            <input type="text" class="form-control ml-sm-1 ml-md-3" name="xvar_ormonth" value="%xdt.ormonth;" %month_input;%/>
          </span>
          <span class="ml-sm-1 ml-md-2">[year/month/day]1</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-1 ml-md-3" name="xvar_oryear" value="%xdt.oryear;" %year_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]0</span>
        </label>
      %elseif;([ !dates order]0 = "mmddyyyy")
        <label>
          <span id="xvar_ormonth_sel">
            <input type="text" class="form-control" name="xvar_ormonth" value="%xdt.ormonth;" %month_input;%/>
          </span>
          <span class="ml-sm-1 ml-md-2">[year/month/day]1</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-1 ml-md-3" name="xvar_orday" value="%xdt.orday;" %day_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]2</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-1 ml-md-3" name="xvar_oryear" value="%xdt.oryear;" %year_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]0</span>
        </label>
      %else;
        <label>
          <input type="text" class="form-control" name="xvar_oryear" value="%xdt.oryear;" %year_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]0</span>
        </label>
        <label>
          <span id="xvar_ormonth_sel">
            <input type="text" class="form-control ml-sm-1 ml-md-3" name="xvar_ormonth" value="%xdt.ormonth;" %month_input;%/>
          </span>
          <span class="ml-sm-1 ml-md-2">[year/month/day]1</span>
        </label>
        <label>
          <input type="text" class="form-control ml-sm-1 ml-md-3" name="xvar_orday" value="%xdt.orday;" %day_input;%/>
          <span class="ml-sm-1 ml-md-2">[year/month/day]2</span>
        </label>
      %end;
    </div>
    <div class="col-10 col-lg">
      <label for="xvar_text" class="col-form-label sr-only"></label>
      <input type="text" class="form-control" name="xvar_text" maxlength="100" value="%xdt.text;" id="xvar_text" placeholder="…[or] [text]0" xcond%/>
    </div>
  </div>
%end;

%define;note(xx)
  <div class="row">
    <label for="xx_note" class="col-2 col-form-label">[*note/notes]1</label>
    <div class="col-10">
       <textarea class="form-control" name="xx_note" id="xx_note" rows="1" %l_on1s;>%xx_note;</textarea>
    </div>
  </div>
%end;

%define;source(xx)
  <div class="row">
    <label for="xx_src" class="col-2 col-form-label">[*source/sources]0</label>
    <div class="col-10">
      <textarea class="form-control" name="xx_src" id="xx_src" rows="1" placeholder="[*source/sources]0" %l_on1s;>%xx_src;</textarea>
    </div>
  </div>
%end;

%define;selector_pevent(xcnt)
  <select class="form-control font-weight-bold" id="pevent_selectxcnt" onchange="show_pevent_label($('#e_namexcnt').prop('defaultValue'), 'xcnt')">
    <option value="">[*custom event]</option>
    <option disabled>──────────</option>
    <option value="#acco" %if;(event.e_name = "#acco") selected%end;>[*accomplishment]</option>
    <option value="#acqu" %if;(event.e_name = "#acqu") selected%end;>[*acquisition]</option>
    <option value="#adhe" %if;(event.e_name = "#adhe") selected%end;>[*adhesion]</option>
    <option value="#barm" %if;(event.e_name = "#barm") selected%end;>[*bar mitzvah]</option>
    <option value="#basm" %if;(event.e_name = "#basm") selected%end;>[*bat mitzvah]</option>
    <option value="#bles" %if;(event.e_name = "#bles") selected%end;>[*benediction]</option>
    <option value="#chgn" %if;(event.e_name = "#chgn") selected%end;>[*change name]</option>
    <option value="#circ" %if;(event.e_name = "#circ") selected%end;>[*circumcision]</option>
    <option value="#conf" %if;(event.e_name = "#conf") selected%end;>[*confirmation]</option>
    <option value="#awar" %if;(event.e_name = "#awar") selected%end;>[*decoration]</option>
    <option value="#demm" %if;(event.e_name = "#demm") selected%end;>[*demobilisationMilitaire]</option>
    <option value="#degr" %if;(event.e_name = "#degr") selected%end;>[*diploma]</option>
    <option value="#dist" %if;(event.e_name = "#dist") selected%end;>[*distinction]</option>
    <option value="#endl" %if;(event.e_name = "#endl") selected%end;>[*dotation]</option>
    <option value="#educ" %if;(event.e_name = "#educ") selected%end;>[*education]</option>
    <option value="#elec" %if;(event.e_name = "#elec") selected%end;>[*election]</option>
    <option value="#emig" %if;(event.e_name = "#emig") selected%end;>[*emigration]</option>
    <option value="#exco" %if;(event.e_name = "#exco") selected%end;>[*excommunication]</option>
    <option value="#fcom" %if;(event.e_name = "#fcom") selected%end;>[*firstCommunion]</option>
    <option value="#fune" %if;(event.e_name = "#fune") selected%end;>[*funeral]</option>
    <option value="#grad" %if;(event.e_name = "#grad") selected%end;>[*graduate]</option>
    <option value="#hosp" %if;(event.e_name = "#hosp") selected%end;>[*hospitalisation]</option>
    <option value="#illn" %if;(event.e_name = "#illn") selected%end;>[*illness]</option>
    <option value="#immi" %if;(event.e_name = "#immi") selected%end;>[*immigration]</option>
    <option value="#lpas" %if;(event.e_name = "#lpas") selected%end;>[*listePassenger]</option>
    <option value="#mdis" %if;(event.e_name = "#mdis") selected%end;>[*militaryDistinction]</option>
    <option value="#mpro" %if;(event.e_name = "#mpro") selected%end;>[*militaryPromotion]</option>
    <option value="#mser" %if;(event.e_name = "#mser") selected%end;>[*militaryService]</option>
    <option value="#mobm" %if;(event.e_name = "#mobm") selected%end;>[*mobilisationMilitaire]</option>
    <option value="#natu" %if;(event.e_name = "#natu") selected%end;>[*naturalisation]</option>
    <option value="#occu" %if;(event.e_name = "#occu") selected%end;>[*occupation/occupations]0</option>
    <option value="#ordn" %if;(event.e_name = "#ordn") selected%end;>[*ordination]</option>
    <option value="#prop" %if;(event.e_name = "#prop") selected%end;>[*property]</option>
    <option value="#cens" %if;(event.e_name = "#cens") selected%end;>[*recensement]</option>
    <option value="#resi" %if;(event.e_name = "#resi") selected%end;>[*residence]</option>
    <option value="#reti" %if;(event.e_name = "#reti") selected%end;>[*retired]</option>
    <option value="#vteb" %if;(event.e_name = "#vteb") selected%end;>[*venteBien]</option>
    <option value="#will" %if;(event.e_name = "#will") selected%end;>[*will]</option>
    <option disabled>──────────</option>
    <option value="#bapl" %if;(event.e_name = "#bapl") selected%end;>[*baptismLDS]</option>
    <option value="#conl" %if;(event.e_name = "#conl") selected%end;>[*confirmation LDS]</option>
    <option value="#dotl" %if;(event.e_name = "#dotl") selected%end;>[*dotationLDS]</option>
    <option value="#flkl" %if;(event.e_name = "#flkl") selected%end;>[*familyLinkLDS]</option>
    <option value="#slgc" %if;(event.e_name = "#slgc") selected%end;>[*scellentChildLDS]</option>
    <option value="#slgp" %if;(event.e_name = "#slgp") selected%end;>[*scellentParentLDS]</option>
    <option value="#slgs" %if;(event.e_name = "#slgs") selected%end;>[*scellentSpouseLDS]</option>
  </select>
%end;

%define;insert_pevent(xcnt)
  <div class="row my-1">
    <label for="ins_eventxcnt_n" class="col-2 col-form-label">[*insert]</label>
    <div class="input-group col-10">
      <select class="custom-select col-1 border border-dark" id="ins_eventxcnt_n" name="ins_eventxcnt_n">
        %for;i;1;11;<option>%i;</option> %end;
      </select>
      <div class="input-group-append">
        <label class="btn btn-outline-secondary mb-0"> [event/events]0/[event/events]1
          <input class="ml-1" type="checkbox" name="ins_eventxcnt" value="on">
        </label>
        <button type="submit" class="btn btn-outline-secondary" title="[*insert::event/events]0/[event/events]1">OK</button>
      </div>
    </div>
  </div>
%end;

%define;insert_witness(xcnt, wcnt, evt_name)
  <div class="row my-2">
    <label for="excnt_ins_witnwcnt_n" class="col-2 col-form-label">[*insert]</label>
    <div class="input-group col-10">
      <select class="custom-select border border-dark col-1" id="excnt_ins_witnwcnt_n" name="excnt_ins_witnwcnt_n">
        %for;i;1;11;<option>%i;</option> %end;
      </select>
      <div class="input-group-append">
        <label class="btn btn-outline-secondary mb-0"> [witness/witness/witnesses]0/[witness/witness/witnesses]2
          <input class="ml-1" type="checkbox" name="excnt_ins_witnwcnt" value="on">
        </label>
        <button type="submit" class="btn btn-outline-secondary" title="[*insert::witness/witness/witnesses]0(s)">OK</button>
      </div>
    </div>
  </div>
%(<table style="border-width:1">
    <tr>
      <td>
        [*insert]&nbsp;
        <input type="text" name="excnt_ins_witnwcnt_n" size="1" maxlength="1" value="1" onkeydown= "if(event.keyCode == 13) document.getElementById('excnt_ins_witnwcnt').value = 'on';" %/>
        </label> [nouveau(x)::witness/witnesses]0 %if;("evt_name" = "#bapt")/ [godfather/godmother/godparents]2%end;
        <input type="hidden" name="excnt_ins_witnwcnt" id="excnt_ins_witnwcnt" readonly/>
        <input type="submit" onclick="%if;("evt_name" = "buri_or_crem")set_buri(xcnt);%end; %if;("evt_name" = "#deat")set_insert_death(xcnt);%end; document.forms['form_pers'].action += '#witn';document.getElementById('excnt_ins_witnwcnt').value = 'on'" value="ok" readonly/>
      </td>
    </tr>
  </table>%)
%end;

%define;one_witness(xcnt, wcnt, evt_name)
  <div class="form-group mt-1">
    <div class="row">
      <h5 class="col-form-label col-2">[*witness/witness/witnesses]0 wcnt </h5>
      <div class="col-2">
        <select class="form-control" name="excnt_witnwcnt_p">
          <option value="link"  %if;(witness.create = "link") selected%end;>[*link]0</option>
          <option value="create"%if;(witness.create = "create") selected%end;>[*create]0</option>
        </select>
      </div>
      <div class="col-3">
        <select class="form-control" name="excnt_witnwcnt_kind">
          %if;(event.e_name = "#bapt")<option value="godp" %if;(witness_kind = "godp") selected %end;>[*godfather/godmother/godparents]2</option>%end;
          <option value="offi" %if;(witness_kind = "offi") selected %end;>[*officer/officer/officers]0</option>
          <option value=""     %if;(witness_kind = "")     selected %end;>[*witness/witness/witnesses]0</option>
        </select>
      </div>
    </div>
    <div class="row">
      <label for="excnt_witnwcnt_fn" class="col-2 col-form-label">[*first name/first names]0</label>
      <div class="col-5">
        <input type="text" class="form-control" name="excnt_witnwcnt_fn" maxlength="200" value="%witness.first_name;" id="excnt_witnwcnt_fn" placeholder="[*first name/first names]0">
      </div>
      <label for="excnt_witnwcnt_occ" class="col col-form-label">[*number]0</label>
      <div class="col">
        <input type="number" class="form-control" name="excnt_witnwcnt_occ" min="0" value="%witness.occ;" id="excnt_witnwcnt_occ" placeholder="#">
      </div>
    </div>
    <div class="row">
      <label for="excnt_witnwcnt_sn" class="col-2 col-form-label">[*surname/surnames]0</label>
      <div class="col-5">
        <input type="text" class="form-control" name="excnt_witnwcnt_sn" maxlength="200" value="%witness.surname;" id="excnt_witnwcnt_sn" placeholder="[*surname/surnames]0">
      </div>
      <span class="col col-form-label">[*sex]</span>
      <div class="col mt-2">
        <div class="form-check form-check-inline">
          <label class="form-check-label">
            <input class="form-check-input" type="radio" name="excnt_witnwcnt_sex" value="M" %if;(witness.create.sex = "male") checked%end; title="[*male/female/neuter]0"%/>[M/F]0
          </label>
        </div>
        <div class="form-check form-check-inline">
          <label class="form-check-label">
            <input class="form-check-input" type="radio" name="excnt_witnwcnt_sex" value="N" %if;(witness.create.sex = "neuter") checked%end; title="[*male/female/neuter]2"%/>?
          </label>
        </div>
        <div class="form-check form-check-inline">
          <label class="form-check-label">
            <input class="form-check-input" type="radio" name="excnt_witnwcnt_sex" value="F" %if;(witness.create.sex = "female") checked%end; title="[*male/female/neuter]1"%/>[M/F]1
          </label>
        </div>
      </div>
    </div>
  </div>
%end;

%(<!-- one_empty_witness is not used anymore
%define;one_empty_witness(xcnt, wcnt, evt_name)
  <br%/>
  <table style="border-width:1;width:700">
    <tr>
      <td><b><i>[*witness/witnesses]0</i></b></td>
      <td colspan="2">
        <table border="0" cellspacing="0" cellpadding="0">
          <tr>
            <td>
              <select name="excnt_witnwcnt_p">
                <option value="create"%if;(witness.create)%sp;
                 selected%end;>[*create]0</option>
                <option value="link"%if;(witness.link)%sp;
                 selected%end;>[*link]0</option>
              </select>
              <select name="excnt_witnwcnt_kind" %if;("evt_name" != "#bapt")class="d-none"%end;>
                <option value="" selected>[*witness/witnesses]0</option>
                <option value="godp" %if;("evt_name" = "#bapt") selected %end;>[*godfather/godmother/godparents]2</option>
              </select>
            </td>
            <td>
              <label>
              <input type="radio" name="excnt_witnwcnt_sex" value="M"%nn;
               %if;(witness.create.sex = "male") checked%end;%/>[M/F]0
              </label><label>
              <input type="radio" name="excnt_witnwcnt_sex" value="N"%nn;
               %if;(witness.create.sex = "neuter") checked%end;%/>?
              </label><label>
              <input type="radio" name="excnt_witnwcnt_sex" value="F"%nn;
               %if;(witness.create.sex = "female") checked%end;%/>[M/F]1
              </label>
            </td>
          </tr>
        </table>
      </td>
      <td><a class="astuce" onmouseover="show_explain('updind','relcre',event)" onmouseout="hide_explain('updind',event)">&nbsp;</a></td>
    </tr>
    <tr>
      <td><label for="excnt_witnwcnt_sn">[*surname/surnames]0</label></td>
      <td colspan="3">
        <input type="text" name="excnt_witnwcnt_sn" size="40" maxlength="200"%sp;
         value="" id="excnt_witnwcnt_sn"%/>
      </td>
    </tr>
    <tr>
      <td><label for="excnt_witnwcnt_fn">[*first name/first names]1</label></td>
      <td>
        <input type="text" name="excnt_witnwcnt_fn" size="40" maxlength="200"%sp;
         value="" id="excnt_witnwcnt_fn"%/>
      </td>
      <td align="%right;"><label for="excnt_witnwcnt_occ">[*number]</label></td>
      <td>
        <input type="number" name="excnt_witnwcnt_occ" min="0" %sq;
         value="" id="excnt_witnwcnt_occ"%/>
      </td>
    </tr>
  </table>
%end;
-->%)

%define;one_pevent(xcnt)
  %if;(event.e_name != "#birt" and event.e_name != "#bapt" and event.e_name != "#deat" and event.e_name != "#buri" and event.e_name != "#crem")
    <div class="row">
      <h5 class="col-2 col-form-label"><label for="pevent_selectxcnt" class="mb-0">[*event/events]0 %(xcnt needs a count fonction%)</label></h5>
      <div class="col-4">
        %apply;selector_pevent(xcnt)
      </div>
      <div class="col">
        <label id="pevent_label_selectorxcnt" style="display:none" class="other_evts w-100">
          <input type="text" class="form-control font-weight-bold" name="e_namexcnt" value="%event.e_name;" id="e_namexcnt" placeholder="[*event/events]0"></label>
        </label>
      </div>
    </div>
    <div class="row">
      <label for="e_placexcnt" class="col-2 col-form-label">[*place]</label>
      <div class="col-10">
        <input type="text" class="form-control" name="e_placexcnt" maxlength="200" value="%event.e_place;" id="e_placexcnt" %if;("evt_name" = "#deat") onfocus='set_death_focus(xcnt)'%elseif;("evt_name" = "buri_or_crem") onfocus='set_burial_focus(xcnt)'%end; placeholder="[*place]">
        <a class="astuce" onmouseover="show_explain('updind','place',event)" onmouseout="hide_explain('updind',event)"></a>
      </div>
    </div>
    %apply;date([*date/dates]0, "e_datexcnt", "event_date", "")
    <div class="row">
      <label for="e_notexcnt" class="col-2 col-form-label">[*note/notes]1</label>
      <div class="col-10">
         <textarea class="form-control" name="e_notexcnt" id="e_notexcnt" rows="1" placeholder="[*note/notes]1" %l_on1s;>%event.e_note;</textarea>
      </div>
    </div>
    <div class="row">
      <label for="e_srcxcnt" class="col-2 col-form-label">[*source/sources]0</label>
      <div class="col-10">
        %if;(event.e_src!="")
          <textarea class="form-control" name="e_srcxcnt" id="e_srcxcnt" rows="1" placeholder="[*source/sources]0" %l_on1s;>%event.e_src;</textarea>
        %else;
          <input class="form-control" name="e_srcxcnt" id="e_srcxcnt" maxlength="1000" placeholder="[*source/sources]0" value="%event.e_src;"/>
        %end;
      </div>
    </div>
    %if;has_witness;
      %foreach;witness;
        %apply;one_witness(xcnt, wcnt, "")
        %if;is_last;%apply;insert_witness(xcnt, wcnt, "")%end;
      %end;
    %else;
      %apply;insert_witness(xcnt, "0", "")
    %end;
    <hr>
  %end;
%end

%(<!-- one_empty_pevent is not used anywhere !
%define;one_empty_pevent(xcnt)
  <table style="border-width:1;width:700">
    <tr>
      <td><label for="e_namexcnt">[*event/events]0</label></td>
      <td>
        %apply;selector_pevent(xcnt)
        <label id="pevent_label_selectorxcnt" style="display:none">
          [or]0 [text]0
          <input type="text" name="e_namexcnt" size="40" maxlength="200" value="%event.e_name;" id="e_namexcnt"%/>
        </label>
      </td>
    </tr>
    <tr>
      <td><label for="e_placexcnt">[*place]0</label></td>
      <td>
        <input type="text" name="e_placexcnt" size="90" value="" id="e_placexcnt"%/>
        <a class="astuce" onmouseover="show_explain('updind','place',event)" onmouseout="hide_explain('updind',event)">&nbsp;</a>
      </td>
    </tr>
    %apply;date([*date/dates]0, "e_datexcnt", "event_date", "")
    <tr>
      <td><label for="e_notexcnt">[*note/notes]1</label></td>
      <td>
        <textarea name="e_notexcnt" rows="2" cols="74" id="e_notexcnt"></textarea>
      </td>
    </tr>
    <tr>
      <td><label for="e_srcxcnt">[*source/sources]0</label></td>
      <td>
        <input type="text" name="e_srcxcnt" size="90" value="" id="e_srcxcnt"%/>
      </td>
    </tr>
  </table>
  %apply;insert_witness(xcnt, "0", "")
%end;
-->%)

%define;one_specific_pevent(xcnt, evt_name)
  %if;(event.e_name = "evt_name")
    %if;("evt_name" = "#deat")
      <div class="row">
        <label for="death_selectxcnt" class="col-sm-2 col-form-label">Type</label>
        <div class="ml-3">
          <select class="form-control" name="death" id="death_selectxcnt" onchange="change_death('xcnt')">
            %if;(not has_birth_date and dont_know_if_dead)
              <option value="Auto" selected> -</option>
            %end;
            <option value="NotDead" %if;not_dead; selected%end;>[*alive]</option>
            <option value="DontKnowIfDead" %if;(dont_know_if_dead and has_birth_date)%sp;selected%end;>[*don't know]0%nl;</option>
            <option value="Death" %if;(death.year != "" or death.text != "" or dead_dont_know_when) selected%end;>[*died]2...</option>
            <option value="DeadYoung" %if;died_young; selected%end;>[*died young]2</option>
            <option value="OfCourseDead" %if;of_course_dead; selected%end;>[*of course dead]</option>
          </select>
        </div>
        <div class="ml-4 mt-1">
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="death_reason" value="Killed" id="Killed" %if;dr_killed;checked%end; onclick='set_death_focus(xcnt)'>
            <label class="form-check-label" for="Killed">[*killed (in action)]2</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="death_reason" value="Murdered" id="Murdered" %if;dr_murdered;checked%end; onclick='set_death_focus(xcnt)'>
            <label class="form-check-label" for="Murdered">[*murdered]2</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="death_reason" value="Executed" id="Executed" %if;dr_executed;checked%end; onclick='set_death_focus(xcnt)'>
            <label class="form-check-label" for="Executed">[*executed (legally killed)]2</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="death_reason" value="Disappeared" id="Disappeared" %if;dr_disappeared;checked%end; onclick='set_death_focus(xcnt)'>
            <label class="form-check-label" for="Disappeared">[*disappeared]2</label>
          </div>
          <div class="form-check form-check-inline">
            <input class="form-check-input" type="radio" name="death_reason" value="Unspecified" id="Unspecified" %if;dr_unspecified;checked%end; onclick='set_death_focus(xcnt)'>
            <label class="form-check-label" for="Unspecified">[*unspecified]2</label>
          </div>
        </div>
      </div>
    %end;
    %if;("evt_name" = "#buri" or "evt_name" = "#crem")
      <div class="row">
        <label for="buri_selectxcnt" class="col-sm-2 col-form-label">Type</label>
        <div class="col-sm-10">
          <select class="form-control" id="buri_selectxcnt" onchange="change_buri('xcnt')">
            <option value="" %if;("evt_name" = "") selected %end;>-</option>
            <option value="#buri" %if;("evt_name" = "#buri") selected %end;>[*buried]2</option>
            <option value="#crem" %if;("evt_name" = "#crem") selected %end;>[*cremated]2</option>
          </select>
        </div>
      </div>
    %end;
    <table style="border-width:1;display:none;width:700">
      <tr>
        <td><label for="e_namexcnt">[*event/events]0</label></td>
        <td>
          <input type="text" name="e_namexcnt" size="30" value="%event.e_name;" id="e_namexcnt"%/>
        </td>
      </tr>
    </table>
    <div class="row">
      <label for="e_placexcnt" class="col-sm-2 col-form-label">[*place]</label>
      <div class="col-sm-10">
        <input type="text" class="form-control" name="e_placexcnt" maxlength="200" value="%event.e_place;"%sp; id="e_placexcnt" %if;("evt_name" = "#deat") onfocus='set_death_focus(xcnt)'%end; placeholder="[*place]">
      </div>
    </div>
    %apply;date%with;[*date/dates]0%and;e_datexcnt%and;event_date%and;%if;("evt_name" = "#deat")onfocus='set_death_focus(xcnt)'%end;%end;
    <div class="row">
      <label for="e_notexcnt" class="col-sm-2 col-form-label">[*note/notes]1</label>
      <div class="col-sm-10">
         <textarea class="form-control" name="e_notexcnt" id="e_notexcnt" rows="1" placeholder="[*note/notes]1" %l_on1s;>%event.e_note;</textarea>
      </div>
    </div>
    <div class="row">
      <label for="e_srcxcnt" class="col-sm-2 col-form-label">[*source/sources]0</label>
      <div class="col-sm-10">
        %if;(event.e_src!="")
          <textarea class="form-control" name="e_srcxcnt" id="e_srcxcnt" rows="1" placeholder="[*source/sources]0" %l_on1s;>%event.e_src;</textarea>
        %else;
          <input class="form-control" name="e_srcxcnt" id="e_srcxcnt" maxlength="1000" placeholder="[*source/sources]0" value="%event.e_src;"/>
        %end;
      </div>
    </div>
    %if;(has_witness)
      %foreach;witness;
        %apply;one_witness(xcnt, wcnt, "evt_name")
        %if;is_last;%apply;insert_witness(xcnt, wcnt, "evt_name")%end;
      %end;
    %else;
      %apply;insert_witness(xcnt, "0", "evt_name")
    %end;
  %end;
%end;

%define;one_empty_specific_pevent(xcnt, evt_name)
  %if;("evt_name" = "#deat")
    <div class="row">
      <label for="death_selectxcnt" class="col-sm-2 col-form-label"></label>
      <div class="col col-sm-auto">
        <select class="form-control pr-0" name="death" id="death_selectxcnt" onchange="change_death('xcnt')">
          %if;(not has_birth_date and dont_know_if_dead)
            <option value="Auto" selected> -</option>
          %end;
          <option value="NotDead" %if;not_dead;selected%end;>[*alive]2</option>
          <option value="DontKnowIfDead" %if;(dont_know_if_dead and has_birth_date)%sp;selected%end;>[*don't know]0%nl;</option>
          <option value="Death" %if;(death.year != "" or death.text != "" or dead_dont_know_when) selected%end;>[*died]2</option>
          <option value="DeadYoung" %if;died_young; selected%end;>[*died young]2</option>
          <option value="OfCourseDead" %if;of_course_dead; selected%end;>[*of course dead]</option>
        </select>
      </div>
      <div class="col mt-1">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="death_reason" value="Killed" id="Killed" %if;dr_killed;checked%end; onclick='set_death_focus(xcnt)'>
          <label class="form-check-label" for="Killed">[*killed (in action)]2</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="death_reason" value="Murdered" id="Murdered" %if;dr_murdered;checked%end; onclick='set_death_focus(xcnt)'>
          <label class="form-check-label" for="Murdered">[*murdered]2</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="death_reason" value="Executed" id="Executed" %if;dr_executed;checked%end; onclick='set_death_focus(xcnt)'>
          <label class="form-check-label" for="Executed">[*executed (legally killed)]2</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="death_reason" value="Disappeared" id="Disappeared" %if;dr_disappeared;checked%end; onclick='set_death_focus(xcnt)'>
          <label class="form-check-label" for="Disappeared">[*disappeared]2</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="death_reason" value="Unspecified" id="Unspecified" %if;dr_unspecified;checked%end; onclick='set_death_focus(xcnt)'>
          <label class="form-check-label" for="Unspecified">[*unspecified]2</label>
        </div>
      </div>
    </div>
  %end;
  %if;("evt_name" = "#buri" or "evt_name" = "#crem" or "evt_name" = "buri_or_crem")
    <div class="row">
      <label for="buri_selectxcnt" class="col-sm-2 col-form-label"></label>
      <div class="ml-3">
        <select class="form-control" id="buri_selectxcnt" onchange="change_buri('xcnt')">
          <option value="" %if;("evt_name" = "") selected %end;>-</option>
          <option value="#buri" %if;("evt_name" = "#buri") selected %end;>[*buried]2</option>
          <option value="#crem" %if;("evt_name" = "#crem") selected %end;>[*cremated]2</option>
        </select>
      </div>
    </div>
  %end;
  <table style="border-width:1;display:none;width:700">
    <tr>
      <td><label for="e_namexcnt">[*event/events]0</label></td>
      <td>
        <input type="text" name="e_namexcnt" size="30" value="%if;("evt_name" != "buri_or_crem")%if;("evt_name" != "#deat" or (not not_dead and not dont_know_if_dead))evt_name%end;%end;" id="e_namexcnt"%/> %( should be %evt_name; ? %)
      </td>
    </tr>
  </table>
  <div class="row">
    <label for="e_placexcnt" class="col-sm-2 col-form-label">[*place]</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" name="e_placexcnt" maxlength="200" value="" id="e_placexcnt" %if;("evt_name" = "#deat") onfocus='set_death_focus(xcnt)'%elseif;("evt_name" = "buri_or_crem") onfocus='set_buri(xcnt)'%end; placeholder="[*place]">
    </div>
  </div>
  %if;("evt_name"="#deat")
    %apply;date([*date/dates]0, "e_datexcnt", "event_date", "onfocus='set_death_focus(xcnt)'")
  %elseif("evt_name"="buri_or_crem")
    %apply;date([*date/dates]0, "e_datexcnt", "event_date", "onfocus='set_buri(xcnt)'")
  %else;
    %apply;date([*date/dates]0, "e_datexcnt", "event_date", "")
  %end;
  <div class="row">
    <label for="e_notexcnt" class="col-sm-2 col-form-label">[*note/notes]1</label>
    <div class="col-sm-10">
       <textarea class="form-control" name="e_notexcnt" id="e_notexcnt" rows="1" placeholder="[*note/notes]1" %l_on1s; %if;("evt_name" = "buri_or_crem")onfocus='set_buri(xcnt)'%end;></textarea>
    </div>
  </div>
  <div class="row">
    <label for="e_srcxcnt" class="col-sm-2 col-form-label">[*source/sources]0</label>
    <div class="col-sm-10">
      <input type="text" class="form-control" name="e_srcxcnt" value="" id="e_srcxcnt" placeholder="[*source/sources]0"  %if;("evt_name" = "buri_or_crem")onfocus='set_buri(xcnt)'%end;>
    </div>
  </div>
  %(
  %if;("evt_name" = "#bapt")
    %apply;one_empty_witness(xcnt, "1", "evt_name")
    %apply;one_empty_witness(xcnt, "2", "evt_name")
  %end;
  %if;("evt_name" = "#bapt")
    %apply;insert_witness(xcnt, "1", "evt_name")
  %else;
    %apply;insert_witness(xcnt, "0", "evt_name")
  %end;
  %)
  %apply;insert_witness(xcnt, "0", "evt_name")
%end
%let;l_on1s;onkeydown="if (event.keyCode == 13) if (!event.shiftKey) javascript:document.upd.submit()"%in;
<form name="upd" method="post" action="%action;">
  <div class="row">
    %apply;nav()
  </div>
  <div class="row">
    %hidden;
    <input type="hidden" name="digest" value="%digest;"%/>
    <input type="hidden" name="i" value="%index;"%/>
    %if;(evar_m = "MRG_IND_OK" or evar_m = "MRG_MOD_IND_OK")
      %if;(evar_i2 != "")
        <input type="hidden" name="i2" value="%evar_i2;">
      %end;
      %if;(evar_ini1 != "" and evar_ini2 != "")
        <input type="hidden" name="ini1" value="%evar_ini1;"%/>
        <input type="hidden" name="ini2" value="%evar_ini2;"%/>
      %end;
      %if;(evar.iexcl != "" or evar.fexcl != "")
        <input type="hidden" name="ip" value="%evar.ip;"%/>
        %if;(evar.iexcl != "")
          <input type="hidden" name="iexcl" value="%evar.iexcl;"%/>
        %end;
        %if;(evar.fexcl != "")
          <input type="hidden" name="fexcl" value="%evar.fexcl;"%/>
        %end;
      %end;
      <input type="hidden" name="m" value="MRG_MOD_IND_OK"%/>
    %elseif;(evar_m = "MOD_IND" or evar_m = "MOD_IND_OK")
      <input type="hidden" name="m" value="MOD_IND_OK"%/>
    %else;
      <input type="hidden" name="m" value="ADD_IND_OK"%/>
    %end;
  </div>
<div class="card">
<h2 class="card-header">%nn;
  %if;(evar_m = "MRG_IND_OK" or evar_m = "MRG_MOD_IND_OK")
    [*merge::person/persons]1[:] %first_name; %surname;
    %if;(first_name != "?" and surname != "?")
      %sp;<span class="reference">([reference key][:] %first_name;.%if;(occ = "")0%else;%occ;%end; %surname)</span>
    %end;
  %elseif;(evar_m = "MOD_IND" or evar_m = "MOD_IND_OK")
    [*modify::person/persons]0[:] %first_name;.%if;(occ = "")0%else;%occ;%end; %surname;
  %else;
    [*add::person/persons]0%end;
</h2>
<div class="card-body">
  <h5 class="card-title"><b>[*other action][:] </b>
    <a href="%prefix;m=CHG_EVT_IND_ORD;i=%index;" title="[*changed order of person's events]">[*invert::event/events]1</a> |
    %if;(bvar.can_send_image != "no" and image = "" and first_name != "?" and surname != "?")
      <a href="%prefix;m=SND_IMAGE;i=%index;">[*modify::]/[delete::]/[add picture]</a>
    %end; | <a href="%prefix;m=MRG;i=%index;">[*merge::]</a> | <a href="%prefix;m=DEL_IND;i=%index;">[*delete::]</a></h5>
  <div class="form-group mt-4">
    <div class="row">
      <label for="first_name" class="col-sm-2 col-form-label">[*first name/first names]0</label>
      <div class="col-sm-6">
        <input type="text" class="form-control" name="first_name" maxlength="200" value="%first_name;" id="first_name" placeholder="[*first name/first names]0">
      </div>
      <label for="occ" class="col col-form-label">[*number]0</label>
      <div class="col">
        <input type="number" class="form-control" name="occ" min="0" value="%if;(occ="")0%else;%occ;%end;" id="occ">
      </div>
    </div>
    <div class="row">
      <label for="surname" class="col-sm-2 col-form-label">[*surname/surnames]0</label>
      <div class="col-sm-6">
        <input type="text" class="form-control" name="surname" maxlength="200" value="%surname;" id="surname" placeholder="[*surname/surnames]0">
      </div>
      <span class="col col-form-label">[*sex]</span>
      <div class="col mt-2">
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="sex" value="M" id="sexM" %if;is_male;checked%end; title="[*male/female/neuter]0"%/>
          <label class="form-check-label" for="sexM">[M/F]0</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="sex" value="N" id="sexU" %if;not(is_male or is_female)checked%end; title="[*male/female/neuter]2"%/>
          <label class="form-check-label" for="sexU">?</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="radio" name="sex" value="F" id="sexF" %if;is_female;checked%end; title="[*male/female/neuter]1"%/>
          <label class="form-check-label" for="sexF">[M/F]1</label>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col-8">
        <div class="row">
        <label for="public_name" class="col-sm-3 col-form-label">[*public name]</label>
        <div class="col-sm-9">
          <input type="text" class="form-control" name="public_name" value="%public_name;" id="public_name" placeholder="[*public name]">
        </div>
        <label for="image" class="col-sm-3 col-form-label mt-3">[*image/images]0</label>
        <div class="col-sm-9 mt-3">
          <input type="text" class="form-control" name="image" value="%image;" id="image" placeholder="[*image/images]0">
        </div>
        </div>
      </div>
      <div class="col-4 d-flex px-0">
        <span class="col col-form-label">[*access]0</span>
        <div class="col mt-2">
          <div class="form-check">
            <input class="form-check-input" type="radio" name="access" value="IfTitles" id="IfTitles" %if;acc_if_titles; checked%end;>
            <label class="form-check-label" for="IfTitles">[*if titles]0</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="access" value="Public" id="Public" %if;acc_public; checked%end;>
            <label class="form-check-label" for="Public">[*public]0</label>
          </div>
          <div class="form-check">
            <input class="form-check-input" type="radio" name="access" value="Private" id="Private" %if;acc_private; checked%end;>
            <label class="form-check-label" for="Private">[*private]0</label>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="form-group">
    %if;has_qualifiers;
      %foreach;qualifier;
        <div class="row">
          <label for="qualifier%cnt;" class="col-sm-2 col-form-label">[*qualifier]0</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" name="qualifier%cnt;" value="%qualifier;" id="qualifier%cnt;" placeholder="[*qualifier]0">
          </div>
          <label for="add_qualifier%cnt;" class="col-sm-3 col-form-label">
            <input type="checkbox" name="add_qualifier%cnt;" value="on" id="add_qualifier%cnt;"> [*insert::qualifier]
          </label>
        </div>
      %end;
    %elseif;(bvar.propose_qualifier != "no")
      <div class="row">
        <label for="qualifier0" class="col-sm-2 col-form-label">[*qualifier]0</label>
        <div class="col-sm-6">
          <input type="text" class="form-control" name="qualifier0" value="" id="qualifier0" placeholder="[*qualifier]0">
        </div>
        <label for="add_qualifier0" class="col-sm-3 col-form-label">
          <input type="checkbox" name="add_qualifier0" value="on" id="add_qualifier0"> [*insert::qualifier]
        </label>
      </div>
    %end;
    %if;has_aliases;
      %foreach;alias;
        <div class="row">
          <label for="alias%cnt;" class="col-sm-2 col-form-label">[*alias]0</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" name="alias%cnt;" value="%alias;" id="alias%cnt;" placeholder="[*alias]0">
          </div>
          <label for="add_alias%cnt;" class="col-sm-3 col-form-label">
            <input type="checkbox" name="add_alias%cnt;" value="on" id="add_alias%cnt;"> [*insert::alias]
          </label>
        </div>
      %end;
    %elseif;(bvar.propose_alias != "no")
      <div class="row">
        <label for="alias0" class="col-sm-2 col-form-label">[*alias]0</label>
        <div class="col-sm-6">
          <input type="text" class="form-control" name="alias0" value="" id="alias0" placeholder="[*alias]0">
        </div>
        <label for="add_alias0" class="col-sm-3 col-form-label">
          <input type="checkbox" name="add_alias0" value="on" id="add_alias0"> [*insert::alias]
        </label>
      </div>
    %end;
    %if;has_first_names_aliases;
      %foreach;first_name_alias;
        <div class="row">
          <label for="first_name_alias%cnt;" class="col-sm-2 col-form-label">[*first name alias]0</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" name="first_name_alias%cnt;" value="%first_name_alias;" id="first_name_alias%cnt;" placeholder="[*first name alias]0">
          </div>
          <label for="add_first_name_alias%cnt;" class="col-sm-3 col-form-label">
            <input type="checkbox" name="add_first_name_alias%cnt;" value="on" id="add_first_name_alias%cnt;"> [*insert::first name alias]
          </label>
        </div>
      %end;
    %else;
      <div class="row">
        <label for="first_name_alias0" class="col-sm-2 col-form-label">[*first name alias]0</label>
        <div class="col-sm-6">
          <input type="text" class="form-control" name="first_name_alias0" value="" id="first_name_alias0" placeholder="[*first name alias]0">
        </div>
        <label for="add_first_name_alias0" class="col-sm-3 col-form-label">
          <input type="checkbox" name="add_first_name_alias0" value="on" id="add_first_name_alias0"> [*insert::first name alias]
        </label>
      </div>
    %end;
    %if;has_surnames_aliases;
      %foreach;surname_alias;
        <div class="row">
          <label for="surname_alias%cnt;" class="col-sm-2 col-form-label">[*surname alias]0</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" name="surname_alias%cnt;" value="%surname_alias;" id="surname_alias%cnt;" placeholder="[*surname alias]0">
          </div>
          <label for="add_surname_alias%cnt;" class="col-sm-3 col-form-label">
            <input type="checkbox" name="add_surname_alias%cnt;" value="on" id="add_surname_alias%cnt;"> [*insert::surname alias]
          </label>
        </div>
      %end;
    %else;
      <div class="row">
        <label for="surname_alias0" class="col-sm-2 col-form-label">[*surname alias]0</label>
        <div class="col-sm-6">
          <input type="text" class="form-control" name="surname_alias0" value="" id="surname_alias0" placeholder="[*surname alias]0">
        </div>
        <label for="add_surname_alias0" class="col-sm-3 col-form-label">
          <input type="checkbox" name="add_surname_alias0" value="on" id="add_surname_alias0"> [*insert::surname alias]
        </label>
      </div>
    %end;
  </div>
  <div class="form-group row">
    <label for="occu" class="col-sm-2 col-form-label">[*occupation/occupations]1</label>
    <div class="col-sm-8">
      %if;(occupation!="")
        <textarea class="form-control" name="occu" rows="1" id="occu" placeholder="[*occupation/occupations]1" %l_on1s;>%occupation;</textarea>
      %else;
        <input class="form-control" name="occu" id="occu" placeholder="[*occupation/occupations]1" value="%occupation;"/>
      %end;
    </div>
  </div>
  <div class="row">
    <label for="src" class="col-sm-2 col-form-label">[*source/sources]0</label>
    <div class="col-sm-8">
      %if;(sources!="")
        <textarea class="form-control" name="src" rows="1" id="src" placeholder="[*source/sources]0" %l_on1s;>%sources;</textarea>
      %else;
        <input class="form-control" name="src" id="src" placeholder="[*source/sources]0" value="%sources;"/>
      %end;
    </div>
    <button type="submit" class="btn btn-outline-success btn-sm col-2" title="[*validate/delete]0"><i class="fa fa-share fa-rotate-180 mx-1" aria-hidden="true"></i><span class="sr-only font-weight-bold">[*validate/delete]0</span></button>
  </div>
  
</div></div>
  <div class="card">
    %apply;card_header("birth","birth")
    <div class="card-body">
      <div class="d-none">
        <table style="border-width:1;width:700">
          <tr>
            <td>[*born]2...</td>
            <td><label for="birth_place">[*place]</label></td>
            <td>
              <input type="text" name="birth_place" size="90" maxlength="200" value="%birth_place;" id="birth_place"%/>
            </td>
          </tr>
        </table>
        %apply;date([*date/dates]0, "birth", "birth", "")
        %apply;note("birth")
        %apply;source("birth")
      </div>
      %if;has_pevent_birth;
        %foreach;pevent;
          %apply;one_specific_pevent(cnt, "#birt")
        %end;
      %else;
        %apply;one_empty_specific_pevent%with;%next_pevent;%and;#birt%end;
        %incr_next_pevent;
      %end;
    </div>
  </div>

  <div class="card">
    %apply;card_header("baptism","baptism")
    <div class="card-body">
      <div class="d-none">
        <table style="border-width:1;width:700">
          <tr>
            <td>[*baptized]2...</td>
            <td><label for="bapt_place">[*place]</label></td>
            <td>
              <input class="form-control" type="text" name="bapt_place" size="90" maxlength="200" value="%bapt_place;" id="bapt_place"%/>
            </td>
          </tr>
        </table>
        %apply;date([*date/dates]0, "bapt", "bapt", "")
        %apply;note("bapt")
        %apply;source("bapt")
      </div>
      %if;has_pevent_baptism;
        %foreach;pevent;
          %apply;one_specific_pevent(cnt, "#bapt")
        %end;
      %else;
        %apply;one_empty_specific_pevent%with;%next_pevent;%and;#bapt%end;
        %incr_next_pevent;
      %end;
    </div>
  </div>

  <div class="card">
    %apply;card_header("death","death")
    <div class="card-body">
      <div class="d-none">
        <table style="border-width:1;width:700">
          <tr>
            <td>
              <select name="old_death" id="death_selectxcnt" onchange="change_death('xcnt')">
                %if;(not has_birth_date and dont_know_if_dead)
                  <option value="Auto" selected> -</option>
                %end;
                <option value="NotDead" %if;not_dead; selected%end;>[*alive]2</option>
                <option value="DontKnowIfDead" %if;(dont_know_if_dead and has_birth_date)%sp;selected%end;>[*don't know]0%nl;</option>
                <option value="Death" %if;(death.year != "" or death.text != "" or dead_dont_know_when) selected%end;>[*died]2</option>
                <option value="DeadYoung" %if;died_young; selected%end;>[*died young]2</option>
                <option value="OfCourseDead" %if;of_course_dead; selected%end;>[*of course dead]</option>
              </select>
            </td>
            <td>
              <label>[*place]0
                <input type="text" name="death_place" size="90" maxlength="200" value="%death_place;" onfocus='setDead()'%/></label>
            </td>
          </tr>
        </table>
        %apply;date([*date/dates]0, "death", "death", "onfocus='setDead()'")
        <table style="border-width:1;width:700">
          <tr>
            <td>
              <label>
                <input type="radio" name="death_reason" value="Killed"%if;dr_killed; checked%end; onclick='set_death_focus(xcnt)'%/>[*killed (in action)]2
              </label><label>
                <input type="radio" name="death_reason" value="Murdered"%if;dr_murdered; checked%end; onclick='set_death_focus(xcnt)'%/>[*murdered]2
              </label><label>
                <input type="radio" name="death_reason" value="Executed"%if;dr_executed; checked%end; onclick='set_death_focus(xcnt)'%/>[*executed (legally killed)]2
              </label><label>
                <input type="radio" name="death_reason" value="Disappeared"%if;dr_disappeared; checked%end; onclick='set_death_focus(xcnt)'%/>[*disappeared]2
              </label><label>
                <input type="radio" name="death_reason" value="Unspecified"%if;dr_unspecified; checked%end; onclick='set_death_focus(xcnt)'%/>[*unspecified]2
              </label>
            </td>
          </tr>
        </table>
        %apply;note("death")
        %apply;source("death")
      </div>
      %if;has_pevent_death;
        %foreach;pevent;
          %apply;one_specific_pevent(cnt, "#deat")
        %end;
      %else;
        %apply;one_empty_specific_pevent%with;%next_pevent;%and;#deat%end;
        %incr_next_pevent;
      %end;
    </div>
  </div>

  <div class="card">
    %apply;card_header("burial","burial")
    <div class="card-body">
      <div class="d-none">
        <table style="border-width:1;width:700">
          <tr>
            <td>
              <select name="burial">
                <option value="UnknownBurial"%if;bt_unknown_burial; selected%end;>-</option>
                <option value="Buried"%if;bt_buried; selected%end;>[*buried]2</option>
                <option value="Cremated"%if;bt_cremated; selected%end;>[*cremated]2</option>
              </select>
            </td>
            <td>
              <label>[*place]0
                <input type="text" name="burial_place" size="90" maxlength="200" value="%burial_place;"%/>
              </label>
            </td>
          </tr>
        </table>
        %apply;date([*date/dates]0, "burial", "burial", "")
        %apply;note("burial")
        %apply;source("burial")
      </div>
      %if;has_pevent_burial;
        %foreach;pevent;
          %apply;one_specific_pevent(cnt, "#buri")
        %end;
      %end;
      %if;has_pevent_cremation;
        %if;has_pevent_burial;<p></p>%end;
        %foreach;pevent;
          %apply;one_specific_pevent(cnt, "#crem")
        %end;
      %end;
      %if;(not has_pevent_burial and not has_pevent_cremation)
        %apply;one_empty_specific_pevent%with;%next_pevent;%and;buri_or_crem%end;
        %incr_next_pevent;
      %end;
    </div>
  </div>
  
  <div class="card">
    %apply;card_header("events","event/events")
    <div class="card-body">
      %if;has_secondary_pevents;
        %foreach;pevent;
          %apply;one_pevent(cnt)
        %end;
        %apply;insert_pevent%with%next_pevent;%end;
        %incr_next_pevent;
      %else;
        %apply;insert_pevent%with%next_pevent;%end;
        %incr_next_pevent;
      %end;
    </div>
  </div>

%define;insert_relation(xx)
  <div class="row">
    <span class="col-form-label col-2">[*insert]</span>
    <div class="btn-group col-10">
      <label class="btn btn-outline-secondary mb-0">1 [relation/relations]0
        <input class="ml-1" type="checkbox" name="add_relationxx" value="on">
      </label>
      <button type="submit" class="btn btn-outline-secondary" title="[*insert::relation/relations]0">OK</button>
    </div>
  </div>
%end;

%define;relation_type(xx)
  <div class="row">
    <h5 class="col-sm-2 col-form-label"><label for="rxx_type" class="mb-0 ">[*relation/relations]0 xx</label></h5>
    <div class="ml-3">
      <select class="form-control" name="rxx_type" id="rxx_type">
        <option value="Undef"%if;relation.rt_empty; selected%end;>-</option>
        <option value="Adoption"%if;relation.rt_adoption; selected%end;>[*adoptive father/adoptive mother/adoptive parents]2</option>
        <option value="Recognition"%if;relation.rt_recognition;%sp;selected%end;>[*recognizing father/recognizing mother/recognizing parents]2</option>
        <option value="CandidateParent"%if;relation.rt_candidate_parent;%sp;selected%end;>[*candidate father/candidate mother/candidate parents]2</option>
        <option value="GodParent"%if;relation.rt_godparent;%sp;selected%end;>[*godfather/godmother/godparents]2</option>
        <option value="FosterParent"%if;relation.rt_foster_parent;%sp;selected%end;>[*foster father/foster mother/foster parents]2</option>
      </select>
    </div>
  </div>
%end;

%define;one_relation(xcnt,xvar,xrel,xsex)
  <div class="form-group">
    <div class="row">
      <label for="rxcnt_xvar_fn" class="col-sm-2 col-form-label">[*first name/first names]0</label>
      <div class="col-sm-5">
        <input type="text" class="form-control" name="rxcnt_xvar_fn" maxlength="200" value="%relation.xrel.first_name;" id="rxcnt_xvar_fn" placeholder="[*first name/first names]0">
      </div>
      <label for="rxcnt_xvar_occ" class="col-sm col-form-label">[*number]0</label>
      <div class="col-sm">
        <input type="number" class="form-control" name="rxcnt_xvar_occ" min="0" value="%relation.xrel.occ;" id="rxcnt_xvar_occ" placeholder="">
      </div>
      <div class="col-sm-2">
        <select class="form-control" name="rxcnt_xvar_p">
          <option value="link"%if;relation.xrel.link; selected%end;>[*link]0</option>
          <option value="create"%if;relation.xrel.create; selected%end;>[*create]0</option>
        </select>
      </div>
    </div>
    <div class="row">
      <label for="rxcnt_xvar_sn" class="col-sm-2 col-form-label">[*surname/surnames]0</label>
      <div class="col-sm-5">
        <input type="text" class="form-control" name="rxcnt_xvar_sn" maxlength="200" value="%relation.xrel.surname;" id="rxcnt_xvar_sn" placeholder="[*surname/surnames]0">
      </div>
      <p class="col-sm-2 mt-1">([sex]0 xsex)</p>
    </div>
  </div>
%end;

  <div class="card">
    %apply;card_header("relations","relation/relations")
    <div class="card-body">
      %apply;insert_relation("0")
      %if;has_relations;
        %foreach;relation;
          <hr>
          %apply;relation_type(cnt)
          %apply;one_relation(cnt,"fath","r_father",[M/F]0)
          %apply;one_relation(cnt,"moth","r_mother",[M/F]1)
          <hr>
          %apply;insert_relation(cnt)
        %end;
      %else;
        <hr>
        %apply;relation_type("1")
        %apply;one_relation("1","fath","r_father",[M/F]0)
        %apply;one_relation("1","moth","r_mother",[M/F]1)
        <hr>
        %apply;insert_relation("1")
      %end;
    </div>
  </div>

%define;insert_title(xcnt)
  <div class="row">
    <label for="ins_titlexcnt_n" class="col-form-label col-2">[*insert]</label>
    <div class="input-group col-10">
      <select class="custom-select border border-dark col-1" id="ins_titlexcnt_n" name="ins_titlexcnt_n">
        %for;i;1;11;<option>%i;</option> %end;
      </select>
      <div class="input-group-append">
        <label class="btn btn-outline-secondary mb-0"> [title/titles]0/[title/titles]1
          <input class="ml-1" type="checkbox" name="ins_titlexcnt" value="on">
        </label>
        <button type="submit" class="btn btn-outline-secondary" title="[*insert::title/titles]0/[title/titles]1">OK</button>
      </div>
    </div>
  </div>
%end;

%define;one_title(xcnt)
  <hr>
  <div class="form-group">
    <div class="row">
      <label for="t_identxcnt" class="col-form-label col-sm-2">[*title/titles]0</label>
      <div class="col-sm-4">
        <input type="text" class="form-control" name="t_identxcnt" value="%title.t_ident;" id="t_identxcnt" placeholder="[*title/titles]0">
      </div>
      <label for="t_placexcnt" class="col-form-label col-sm-2">[*estate]0</label>
      <div class="col-sm-4">
        <input type="text" class="form-control" name="t_placexcnt" value="%title.t_estate;" id="t_placexcnt" placeholder="[*estate]0">
      </div>
    </div>
    <div class="row">
      <label for="t_namexcnt" class="col-form-label col-sm-2">[*name]0</label>
      <div class="col-sm-4">
        <input type="text" class="form-control" name="t_namexcnt" value="%title.t_name;" id="t_namexcnt" placeholder="[*name]0">
      </div>
      <label for="t_nthxcnt" class="col-form-label col-sm-2">[*nth]0</label>
      <div class="col-sm-1">
        <input type="text" class="form-control" name="t_nthxcnt" size="3" value="%title.t_nth;" id="t_nthxcnt" placeholder="#">
      </div>
      <div class="form-inline form-check">
        <input class="form-check-input" id="maintitle" type="checkbox" name="t_main_titlexcnt" value="on" %if;title.t_main; checked%end;>
        <label class="form-check-label" for="maintitle">[*main title]0</label>
      </div>
    </div>
  </div>
  %apply;date([*begin]0, "t_date_startxcnt", "title_date_start", "")
  %apply;date([*end]0, "t_date_endxcnt", "title_date_end", "")
%end

  <div class="card">
    %apply;card_header("titles","title/titles")
    <div class="card-body">
      %apply;insert_title("0")
      %if;has_titles;
        %foreach;title;
          %apply;one_title(cnt)
          <hr>
          %apply;insert_title(cnt)
        %end;
      %else;
        %apply;one_title("1")
        <hr>
        %apply;insert_title("1")
      %end;
    </div>
  </div>

  <div class="card">
    %apply;card_header("notes","note/notes")
    <div class="card-body">
      %let;name;notes%in;
      %(!!broken to repair!! %include.toolbar;%)
      <textarea class="form-control" name="notes" rows="16">%notes;</textarea>%sq;
      <div class="text-center">
        <button type="submit" class="btn btn-outline-success btn-lg col-4 py-3 mt-2 mb-3" title="[*validate/delete]0" aria-label="[*validate/delete]0">
          <span class="font-weight-bold text-uppercase">[*validate/delete]0</span><i class="fa fa-share fa-rotate-180 fa-fw ml-2" aria-hidden="true"></i>
        </button>
      </div>
      %(!!broken to repair!! <div class="ml-1 text-center"> 
        %include.accent;
      </div>%)
    </div>
  </div>
</form>

%base_trailer;
%include.copyr;
</div>
%include.js;
<script>
<!--
function changeCalendar(e,v,m,c) {
  var mv = m;
  switch (m) {
  case "VD": mv = 1; break;
  case "BR": mv = 2; break;
  case "FM": mv = 3; break;
  case "NI": mv = 4; break;
  case "PL": mv = 5; break;
  case "VT": mv = 6; break;
  case "GE": mv = 7; break;
  case "FL": mv = 8; break;
  case "PR": mv = 9; break;
  case "ME": mv = 10; break;
  case "TH": mv = 11; break;
  case "FT": mv = 12; break;
  case "JC": mv = 13; break;
  }
  switch(c.options%[c.selectedIndex%].value) {
  case 'G':
  case 'J':
    document.getElementById(e).innerHTML = '\
<select class="form-control pl-sm-1 pr-lg-0 px-xl-2 %if;([ !dates order]0 != "mmddyyyy")ml-sm-2 ml-md-3%end;" name="' + v + '">\
<option value=""' + (mv == 0 ? ' selected' : '') + '>%nn;
-</option>\
<option value="1"' + (mv == 1 ? ' selected' : '') + '>%nn;
[(month)]0</option>\
<option value="2"' + (mv == 2 ? ' selected' : '') + '>%nn;
[(month)]1</option>\
<option value="3"' + (mv == 3 ? ' selected' : '') + '>%nn;
[(month)]2</option>\
<option value="4"' + (mv == 4 ? ' selected' : '') + '>%nn;
[(month)]3</option>\
<option value="5"' + (mv == 5 ? ' selected' : '') + '>%nn;
[(month)]4</option>\
<option value="6"' + (mv == 6 ? ' selected' : '') + '>%nn;
[(month)]5</option>\
<option value="7"' + (mv == 7 ? ' selected' : '') + '>%nn;
[(month)]6</option>\
<option value="8"' + (mv == 8 ? ' selected' : '') + '>%nn;
[(month)]7</option>\
<option value="9"' + (mv == 9 ? ' selected' : '') + '>%nn;
[(month)]8</option>\
<option value="10"' + (mv == 10 ? ' selected' : '') + '>%nn;
[(month)]9</option>\
<option value="11"' + (mv == 11 ? ' selected' : '') + '>%nn;
[(month)]10</option>\
<option value="12"' + (mv == 12 ? ' selected' : '') + '>%nn;
[(month)]11</option>\
</select>\
';
    break;
  case 'F':
    document.getElementById(e).innerHTML = '\
<select class="form-control pl-sm-1 pr-lg-0 px-xl-2 %if([ !dates order]0 != "mmddyyyy")ml-sm-2 ml-md-3%end;" name="' + v + '">\
<option value=""' + (mv == 0 ? ' selected' : '') + '>%nn;
-</option>\
<option value="1"' + (mv == 1 ? ' selected' : '') + '>%nn;
[(french revolution month)]0</option>\
<option value="2"' + (mv == 2 ? ' selected' : '') + '>%nn;
[(french revolution month)]1</option>\
<option value="3"' + (mv == 3 ? ' selected' : '') + '>%nn;
[(french revolution month)]2</option>\
<option value="4"' + (mv == 4 ? ' selected' : '') + '>%nn;
[(french revolution month)]3</option>\
<option value="5"' + (mv == 5 ? ' selected' : '') + '>%nn;
[(french revolution month)]4</option>\
<option value="6"' + (mv == 6 ? ' selected' : '') + '>%nn;
[(french revolution month)]5</option>\
<option value="7"' + (mv == 7 ? ' selected' : '') + '>%nn;
[(french revolution month)]6</option>\
<option value="8"' + (mv == 8 ? ' selected' : '') + '>%nn;
[(french revolution month)]7</option>\
<option value="9"' + (mv == 9 ? ' selected' : '') + '>%nn;
[(french revolution month)]8</option>\
<option value="10"' + (mv == 10 ? ' selected' : '') + '>%nn;
[(french revolution month)]9</option>\
<option value="11"' + (mv == 11 ? ' selected' : '') + '>%nn;
[(french revolution month)]10</option>\
<option value="12"' + (mv == 12 ? ' selected' : '') + '>%nn;
[(french revolution month)]11</option>\
<option value="13"' + (mv == 13 ? ' selected' : '') + '>%nn;
[(french revolution month)]12</option>\
</select>\
';
    break;
  case 'H':
    document.getElementById(e).innerHTML = '\
<select class="form-control pl-sm-1 pr-lg-0 px-xl-2 %if;([ !dates order]0 != "mmddyyyy")ml-sm-2 ml-md-3%end;" name="' + v + '">\
<option value=""' + (mv == 0 ? ' selected' : '') + '>%nn;
-</option>\
<option value="1"' + (mv == 1 ? ' selected' : '') + '>%nn;
[(hebrew month)]0</option>\
<option value="2"' + (mv == 2 ? ' selected' : '') + '>%nn;
[(hebrew month)]1</option>\
<option value="3"' + (mv == 3 ? ' selected' : '') + '>%nn;
[(hebrew month)]2</option>\
<option value="4"' + (mv == 4 ? ' selected' : '') + '>%nn;
[(hebrew month)]3</option>\
<option value="5"' + (mv == 5 ? ' selected' : '') + '>%nn;
[(hebrew month)]4</option>\
<option value="6"' + (mv == 6 ? ' selected' : '') + '>%nn;
[(hebrew month)]5</option>\
<option value="7"' + (mv == 7 ? ' selected' : '') + '>%nn;
[(hebrew month)]6</option>\
<option value="8"' + (mv == 8 ? ' selected' : '') + '>%nn;
[(hebrew month)]7</option>\
<option value="9"' + (mv == 9 ? ' selected' : '') + '>%nn;
[(hebrew month)]8</option>\
<option value="10"' + (mv == 10 ? ' selected' : '') + '>%nn;
[(hebrew month)]9</option>\
<option value="11"' + (mv == 11 ? ' selected' : '') + '>%nn;
[(hebrew month)]10</option>\
<option value="12"' + (mv == 12 ? ' selected' : '') + '>%nn;
[(hebrew month)]11</option>\
<option value="13"' + (mv == 13 ? ' selected' : '') + '>%nn;
[(hebrew month)]12</option>\
</select>\
';
    break;
  }
}
-->
</script>
<script>
  function change_buri(xcnt) {
    var selector = document.getElementById('buri_select' + xcnt);
    var input = document.getElementById('e_name' + xcnt);
    input.value = selector.value;
  }

  function set_buri(xcnt) {
    var selector = document.getElementById('buri_select' + xcnt);
    if (selector.value == "") {
      selector.value = "#buri";
      change_buri(xcnt);
    }
  }

  function change_death(xcnt) {
    var selector = document.getElementById('death_select' + xcnt);
    var input = document.getElementById('e_name' + xcnt);
    if (selector.value != "NotDead" && selector.value != "DontKnowIfDead") {
      input.value = "#deat";
    }
    else {
      input.value = "";
    }
  }

  function set_death_focus(xcnt) {
    var selector = document.getElementById('death_select' + xcnt);
    selector.value = "Death";
    change_death(xcnt);
  }

  function set_burial_focus(xcnt) {
    var selector = document.getElementById('buri_select' + xcnt);
    selector.value = "#buri";
    change_buri(xcnt);
  }

  function show_pevent_label(xxname, xcnt) {
    var selector = document.getElementById('pevent_select' + xcnt);
    var label = document.getElementById('pevent_label_selector' + xcnt);
    var input = document.getElementById('e_name' + xcnt);
    if (selector.value == "") {
      if (xxname.charAt(0) == "#") {
        input.value = "";
      }
      else {
        input.value = xxname;
      }
    }
    else {
      input.value = selector.value;
    }
    if (selector.value == "" || selector.value.charAt(0) != "#") {
      label.style.display = 'inline';
    }
    else {
      label.style.display = 'none';
    }
  }

  $(document).ready(function(){
     //show evt perso
     $(".other_evts").each(function(){
       var inp = $(this).find("input").first();
       if(inp.val().charAt(0) != "#" && inp.val() != ""){
         $(this).show();
       }
     });
  });
</script>
</body>
</html>
