<!DOCTYPE html>
<html lang="%if;(bvar.default_lang!="" and evar.lang="")%bvar.default_lang;%elseif;(evar.lang!="")%evar.lang;%else;en%end;">
<head>
  <!-- $Id: destable.txt 16/02/2017 01:19:21 $ -->
  <!-- Copyright (c) 1998-2017 INRIA -->
<title>%nn;
  %apply;a_of_b%with;[*descendants]%and;%self;%end;
     %sp;[up to] %evar.v; %if;(evar.v>1)[generation/generations]1%else;[generation/generations]0%end;
</title>
  <meta name="robots" content="none">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="shortcut icon" href="%image_prefix;/favicon_gwd.png">
%include.css;
%base_header;
</head>
<body%body_prop;>
%message_to_wizard;
<div class="container-fluid">
<h1>%nn;
  %apply;a_of_b%with;[*descendants]%and;%self;%end;
   %if;(cancel_links)%sp;[up to] %evar.v; %if;(evar.v>1)[generation/generations]1%else;[generation/generations]0%end;%end;
</h1>

%if;not cancel_links;
  <div class="btn-group float-%right; mb-1">
    %if;(referer != "")
      <a role="button" class="btn btn-link px-0" href="%referer;"><span class="fa fa-arrow-left fa-lg" title="<<"></span></a>
    %end;
    <a role="button" class="btn btn-link ml-1 px-0" href="%url;cgl=on" target="_blank"><span class="fa fa-chain-broken fa-lg" title="[*cancel GeneWeb links]"></span></a>%nn;
    <a role="button" class="btn btn-link ml-1 px-0" href="%prefix;"><span class="fa fa-home fa-lg" title="[*home]"></span></a>
  </div>
%end;

%let;central_index;%index;%in;

%define;tothegen(xxx)
  [*to the %s generation:::xxx]%nn;
%end;

%define;thegen(xxx)
  [*the %s generation:::xxx]%nn;
%end;

%define;image_MF(xxx)
  %if;(wizard and not cancel_links)
    <a href="%prefix;m=MOD_IND;i=%xxx.index;" title="[*modify::] %xxx.first_name;%if;(xxx.occ!="0").%xxx.occ;%end; %xxx.surname;">
  %end;
  %if;xxx.is_male;
    <i class="fa fa-mars male"></i>%nn;
  %elseif;xxx.is_female;
    <i class="fa fa-venus female"></i>%nn;
  %else;
    <i class="fa fa-neuter neuter"></i>%nn;
  %end;%nn;
  %if;(wizard and not cancel_links and not xxx.is_restricted)</a>%end;
%end;

%define;letter(xxx)
  %apply;nth%with;
    /a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y/z
  %and;xxx%end;
%end;

%define;link(aa, xxx)
  %if;(evar.cgl = "on")xxx%else;<a href="%prefix;aa">xxx</a>%end;
%end;

%define;table_header()
  %reset_count;
  <th>[*d'Aboville]</th>
  %incr_count;
  <th colspan="2">[*person/persons]0</th>
  %incr_count;
  %if;(evar.birth = "on")
    <th>[*birth]</th>
    %incr_count;
  %end;
  %if;(evar.birth_place = "on")
    <th>[*where born]</th>
    %incr_count;
  %end;
  %if;(evar.marr = "on" and evar.t="H")
    <th>[*spouse/spouses]1</th>
    %incr_count;
  %end;
  %if;(evar.marr_date = "on")
    <th>[*marriage/marriages]1</th>
    %incr_count;
  %end;
  %if;(evar.marr_place = "on")
    <th>[*where married]</th>
    %incr_count;
  %end;
  %if;(evar.child = "on")
    <th>[*nb children]</th>
    %incr_count;
  %end;
  %if;(evar.death = "on")
    <th>[*death]</th>
    %incr_count;
  %end;
  %if;(evar.death_place = "on")
    <th>[*where dead]</th>
    %incr_count;
  %end;
  %if;(evar.age = "on")
    <th>[*age]</th>
    %incr_count;
  %end;
  %if;(evar.occu = "on")
    <th>[*occupation/occupations]1</th>
    %incr_count;
  %end;
%end;

%(
si t=H on active rowspan pour les données de l’individu et du couple
si t=I on affiche pas les données
%)
%define;table_row(xxx, prefx, fam_cnt, ch_count, yyy, zzz)
  %let;famx;%if;(not has_families or evar.t="I")1%else;fam_cnt%end;%in;
  %let;zro;%if;("prefx"="-1")0%else;1%end;%in;
  %let;row_span;%if;(nb_families>1 and evar.t="H" and (evar.marr = "on" or evar.marr_date = "on" or evar.marr_place = "on"))rowspan="%xxx.nb_families;"%end;%in;
  %if;(famx=1)
    %if;("yyy"="0")
      <td class="align-middle" %row_span;>
      %if;(zro=1)%if;("prefx"!="")prefx.%end;ch_count%else;1%end;
      </td>
    %elseif;(evar.t="I")
      <td></td>
    %end;
  %end;
  %if;(famx=1)
    %if;("yyy"="0")
      <td class="align-middle" %row_span; colspan="2">
        %incr_count1;
        %apply;image_MF("xxx")
        %apply;link%with;%xxx.access;%and;
          %xxx.first_name; %xxx.surname;
        %end
        %xxx.title;
      </td>
    %elseif;(evar.t="I")
      <td class="align-middle border-right-0 pl-2">%if;(zzz.nb_families>1)%apply;letter(family_cnt).%end;</td>
      <td class="align-middle border-left-0">
        %incr_count1;
        %apply;image_MF("xxx")
        %apply;link%with;%xxx.access;%and;
          %xxx.first_name; %xxx.surname;
        %end
        %xxx.title;
        &nbsp; 
      </td>
    %end;
  %end;
  %if;(evar.birth = "on" and famx=1)
    <td class="align-middle text-right" %row_span;>
      %if;(wizard and not cancel_links)
        <a class="d-block" href="%prefix;m=MOD_IND;i=%xxx.index;#birth_" title="[*modify::] %xxx.first_name;%if;(xxx.occ!="0").%xxx.occ;%end; %xxx.surname;">
        %if;(xxx.has_approx_birth_date)%xxx.slash_approx_birth_date;%else;°%end;
        </a>
      %end;
    </td>
  %end;
  %if;(evar.birth_place = "on" and famx=1)
    <td class="align-middle" %row_span;>
      %if;xxx.has_approx_birth_place;
        %xxx.approx_birth_place;
      %end;
    </td>
  %end;
  %if;(evar.marr = "on" and evar.t="H")
    %if;(xxx.nb_families = 0)
      <td></td>
    %else;
      %foreach;xxx.family;
        %if;(family_cnt = fam_cnt)
          <td class="%if;(xxx.nb_families > 1)border-bottom-0%end;">
            %incr_count1;
            %apply;image_MF("spouse")
            %apply;link%with;%spouse.access;%and;
              %spouse;
            %end;
          </td>
        %end;
      %end;
    %end;
  %end;

  %if;(evar.marr_date = "on")
    %if;(xxx.nb_families = 0)
      <td></td>
    %else;
      <td class="align-middle text-right">
      %foreach;xxx.family;
        %if;((evar.t="H" and family_cnt=fam_cnt) or ("yyy"="0" and family_cnt=fam_cnt and family_cnt!=1) or xxx.spouse=zzz)
          %if;(wizard and not cancel_links)
            <a class="d-block" href="%prefix;m=MOD_FAM;i=%family.index;;ip=%index;" title="[*modify::family/families]0 %xxx; [and] %xxx.spouse;">
            %if;(slash_marriage_date != "")%slash_marriage_date;%else;<span class="fa fa-venus-mars
            %if;((xxx.is_male and spouse.xxx.is_female) or (xxx.is_female and xxx.spouse.is_female))venus-mars%elseif;(xxx.is_male and spouse.xxx.is_male)mars-double%else;(xxx.is_female and spouse.xxx.is_female)venus-double%end; fa-rotate-180 small"></span>%end;</a>%nn; %( WIP not working atm %)
          %else;
            %slash_marriage_date;
          %end;
        %end;
      %end;
      </td>
    %end;
  %end;
  %if;(evar.marr_place = "on")
    %if;(xxx.nb_families = 0)
      <td></td>
    %else;
      <td class="align-middle">
      %foreach;xxx.family;
        %if;((evar.t="H" and family_cnt=fam_cnt) or ("yyy"="0" and family_cnt=fam_cnt and family_cnt!=1) or xxx.spouse=zzz)
          %if;(marriage_place != "")
            %marriage_place;
          %end;
        %end;
      %end;
      </td>
    %end;
  %end;
  %if;(evar.child = "on" and famx=1)
    %if;(xxx.nb_families = 0)
      <td></td>
    %else;
      %if;(evar.marr = "on" or evar.marr_date = "on" or evar.marr_place = "on")
        %foreach;xxx.family;
          %if;(family_cnt = fam_cnt)
            <td class="text-center align-middle" %row_span;>
              %if;("yyy"!="1")%xxx.nb_children_tot;
              %elseif;(("yyy"="1" and evar.t="I") or evar.t="H")%xxx.nb_children; %if;(xxx.nb_children!=xxx.nb_children_tot)(%xxx.nb_children_tot;)%end;
              %end;
            </td>
          %end;
        %end;
      %else;
        <td class="text-center align-middle">%xxx.nb_children_tot;
          %if;(xxx.nb_families>1) <sup title="%xxx.nb_families; %if;(xxx.nb_families>1)[family/families]1%else;[family/families]0%end;">(%xxx.nb_families;)</sup>%end;
        </td>
      %end;
    %end;
  %end;
  %if;(evar.death = "on" and famx=1)
    <td class="align-middle text-right" %row_span;>
      %if;(wizard and not cancel_links)
        <a class="d-block" href="%prefix;m=MOD_IND;i=%xxx.index;#death_" title="[*modify::] %xxx.first_name;%if;(xxx.occ!="0").%xxx.occ;%end; %xxx.surname;">
          %if;xxx.has_approx_death_date;
            %xxx.slash_approx_death_date;
          %elseif;xxx.is_dead;
            †
          %end;
        </a>
      %end;
    </td>
  %end;
  %if;(evar.death_place = "on" and famx=1)
    <td class="align-middle" %row_span;>
      %if;xxx.has_approx_death_date;
        %xxx.approx_death_place;
      %end;
    </td>
  %end;
  %if;(evar.age = "on" and famx=1)
    <td class="align-middle" %row_span;>
      %if;xxx.computable_death_age;̣† %xxx.death_age;%end;
      %if;xxx.computable_age;%xxx.age;%end;
    </td>
  %end;
  %if;(evar.occu = "on" and famx=1)
    <td class="align-middle" %row_span;>
      %if;(xxx.has_occupation)
        %xxx.occupation
      %end;
    </td>
  %end;
%end;

%( initialise le compteur à/avec la valeur passée en paramètre %)
%define;init_count(prev_count)
  %reset_count;
  %for;i;0;prev_count;
    %incr_count;
  %end;
%end;

%define;one_child(xxx, prefx)
  %incr_count;
  %let;prfx;prefx%in;
  %if;xxx.has_families;
    %if;(evar.t="H")
      %foreach;family;
        <tr>
        %apply;table_row("xxx", prfx, family_cnt, count, "0", "xxx")
        </tr>
      %end;
    %elseif;(evar.t="I")
        <tr>
        %apply;table_row("xxx", prfx, 1, count, "0", "xxx")
        </tr>
      %if;(evar.marr = "on" or evar.marr_date = "on" or evar.marr_place = "on")
        %foreach;family;
          <tr>
          %apply;table_row("xxx.spouse", prfx, 1, count, "1", "xxx")
          </tr>
        %end;
      %end;
    %end;
  %else;
    <tr>
      %apply;table_row("xxx", prfx, family_cnt, count, "0", "xxx")
    </tr>
  %end;
%end;

%define;one_family(xxx, prefx)
  %reset_count;
    %let;prfx;prefx%in;
    %foreach;family;
      %let;fam;%apply;letter(family_cnt)%in;
      %let;nprfx;%if;(nb_families>1)%prfx;%fam;%else;%prfx;%end;%in;
      %foreach;xxx.child;
        %apply;one_child("xxx", nprfx)
      %end;
    %end;
%end;

%define;one_level(xxx, lv, max_l, prefx, ch_cnt)
  %let;npref;%if;("prefx"!="")prefx.%end;ch_cnt%in;
  %if;(lv<max_l)
    %if;xxx.has_families;
      %foreach;family;
        %let;fam;%apply;letter(family_cnt)%in;
        %let;nnpref;%if;(nb_families>1)%npref;%fam;%else;%npref;%end;%in;
        %foreach;child;
          %apply;one_level("child", lv+1, max_l, nnpref, child_cnt)
        %end;
      %end;
    %else;
    %end
  %else;
    %apply;one_family("self", npref)
  %end;
%end;

%define;rebuild_url(MMM,XXX,vvv)
  %let;new_url;%prefix;m=MMM;%nn;
  p=%first_name;;n=%surname;;oc=%occ;;t=XXX;%nn;
  %if;(evar.birth = "on")
    birth=on;%nn;
  %end;
  %if;(evar.birth_place = "on")
    birth_place=on;%nn;
  %end;
  %if;(evar.marr= "on")
    marr=on;%nn;
  %end;
  %if;(evar.marr_date = "on")
    marr_date=on;%nn;
  %end;
  %if;(evar.marr_place = "on")
    marr_place=on;%nn;
  %end;
  %if;(evar.child = "on")
    child=on;%nn;
  %end;
  %if;(evar.death = "on")
    death=on;%nn;
  %end;
  %if;(evar.death_place = "on")
    death_place=on;%nn;
  %end;
  %if;(evar.age = "on")
    age=on;%nn;
  %end;
  %if;(evar.occu = "on")
    occu=on;%nn;
  %end;
  %if;(evar.gen = "on")
    gen=on;%nn;
  %end;
  %if;(evar.cgl = "on")
    cgl=on;%nn;
  %end;
  v=vvv;%in;
  %new_url;
%end;

%if;(not cancel_links)
  %if;(evar.marr="on" or evar.marr_place="on" or evar.marr_date="on")
    <a role="button" class="btn btn-link mx-0 px-0 mb-1" href="%apply;rebuild_url%with;D%and;%if;(evar.t="H")I%elseif;(evar.t="I")H%end;%and;%evar.v;%end;"><i class="fa fa-table fa-lg fa-fw mr-1"></i>%nn;
    %if;(evar.t="H")[*visualize/show/hide/summary]1%else;[*visualize/show/hide/summary]2%end; [spouses info]0</a>
  %end;
  <a role="button" class="btn btn-link ml-2 my-0 px-0 mb-1" href="%prefix;p=%first_name;;n=%surname;;m=D"><i class="fa fa-cog fa-lg fa-fw mr-1"></i>[*options] [descendants] </a>
  <a role="button" class="btn btn-link ml-2 my-0 px-0 mb-1" href="%apply;rebuild_url%with;A%and;Z;%and;%if;(evar.v="" or evar.v<=2)2%else;%evar.v;%end;%end" class="btn btn-secondary"><span class="fa fa-sitemap fa-lg fa-fw fa-rotate-180 mr-1"></span>[*table] [ancestors]</a>
  <div class="btn-group ml-3" role="group" aria-label="First group">
    %if;(evar.v>=1)<a href="%apply;rebuild_url%with;D%and;%evar.t;%and;%expr(evar.v-1)%end" class="btn btn-secondary" title="-1 [generation/generations]0">-</a>%end;
    <input class="form-control text-center" size="12" value="%if;(evar.v="")0%else;%evar.v;%end; %if;(evar.v>1)[generation/generations]1%else;[generation/generations]0%end;" disabled>
    <a href="%apply;rebuild_url%with;D%and;%evar.t;%and;%expr(evar.v+1)%end" class="btn btn-secondary" title="+1 [generation/generations]0">+</a>
  </div>
%end;

<table class="table table-sm ascends_table mt-2">
  %reset_count;
  <tr class="ascends_table_header">%apply;table_header()</tr>
  %let;nb_col;%expr(count+1)%in;
  %let;max;%evar.v;%in;
  %reset_count;
  %reset_count1;
  %apply;one_child("self", "-1")
  %for;lev;0;max;
    <tr>
      <th colspan="%nb_col;">[*generation/generations]0 %expr(lev+1)</th>
    </tr>
    %apply;one_level("self", 0, lev, "", 1)
  %end;
</table>

%define;desc_count()
  %foreach;descendant_level;
    %if;(level=max_desc_level)%number_of_descendants;%end;
  %end;
%end;
<p>[*total][:] %apply;desc_count() [descendants] %if;(evar.marr="on")(%count1; [person/persons]1 [with] [spouse/spouses]1)%end;</p>

%include.trl;
%include.copyr;
</div>
%include.js;
</body>
</html>
