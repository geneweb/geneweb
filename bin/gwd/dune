(rule
 (target gwdPluginMD5.ml)
 (deps
  (alias_rec %{project_root}/plugins/plugin)
  (:maker mk_gwdPluginMD5.ml))
 (action
  (with-stdout-to
   %{target}
   (run ocaml %{maker} %{project_root}/plugins))))

(generate_sites_module
 (module geneweb_sites)
 (sites geneweb))

(library
 (name gwd_lib)
 (public_name geneweb.gwd_lib)
 (libraries geneweb wserver dune-site cmdliner)
 (modules gwdPlugin request geneweb_sites cmd))

(executable
 (package geneweb)
 (name gwd)
 (public_name gwd)
 (flags -linkall)
 (libraries
  dynlink
  geneweb
  geneweb.logs
  gwd_lib
  logs
  logs.fmt
  logs-syslog
  logs-syslog.unix
  fmt
  fmt.tty
  str
  unix
  uri
  wserver)
 (modules base64 gwd gwdPluginDep gwdPluginMD5 gwdPluginMETA robot))
