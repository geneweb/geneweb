(dirs :standard \ %%%DUNE_DIRS_EXCLUDE%%%)

(ocamllex (modules templ_parser))

#ifdef API
(rule
  (deps api_link_tree.piqi)
  (targets api_link_tree_piqi.ml api_link_tree_piqi_ext.ml)
  (action (run piqic-ocaml --ext api_link_tree.piqi))
)
#endif

(library
 (name geneweb)
 (public_name geneweb)
 (synopsis "GeneWeb library")
 (preprocess (action (run %{bin:cppo} %%%CPPO_D%%% -V OCAML:%{ocaml_version} %{input-file})))
 (libraries unix
            %%%API_PKG%%%
            str
            stdlib-shims
            camlp5
            geneweb_core
            geneweb_def
            geneweb_gwdb
            geneweb_sosa_mli
            geneweb_util
            markup)
 (modules_without_implementation templAst)
)
