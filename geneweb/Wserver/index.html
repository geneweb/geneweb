<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Wserver (geneweb.Wserver)</title><link rel="stylesheet" href="../../odoc.support/odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.2.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../odoc.support/highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">geneweb</a> &#x00BB; Wserver</nav><header class="odoc-preamble"><h1>Module <code><span>Wserver</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value anchored" id="val-f"><a href="#val-f" class="anchor"></a><code><span><span class="keyword">val</span> f : 
  <span><span>(<span><span>[ `LOG_EMERG
   <span>| `LOG_ALERT</span>
   <span>| `LOG_CRIT</span>
   <span>| `LOG_ERR</span>
   <span>| `LOG_WARNING</span>
   <span>| `LOG_NOTICE</span>
   <span>| `LOG_INFO</span>
   <span>| `LOG_DEBUG</span> ]</span> <span class="arrow">&#45;&gt;</span></span>
    <span>string <span class="arrow">&#45;&gt;</span></span>
    unit)</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>string option</span> <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span>int <span class="arrow">&#45;&gt;</span></span>
  <span><span>int option</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>(<span><span>(<span class="xref-unresolved">Unix</span>.sockaddr * <span>string list</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="../Adef/index.html#type-encoded_string">Adef.encoded_string</a> <span class="arrow">&#45;&gt;</span></span> unit)</span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p><code> Wserver.f syslog addr port tmout maxc g </code> Starts an elementary httpd server at port <code>port</code> in the current machine. The variable <code>addr</code> is <code>Some the-address-to-use</code> or <code>None</code> for any of the available addresses of the present machine. The port number is any number greater than 1024 (to create a client &lt; 1024, you must be root). At each connection, the function <code>g</code> is called: <code>g (addr, request) path query</code> where <code>addr</code> is the client identification socket, <code>request</code> the browser request, <code>path</code> the part of the <code>request</code> before the query part and <code>query</code> the query content. The function <code>g</code> has <code>tmout</code> seconds to answer some text on standard output. If <code>maxc</code> is <code>Some n</code>, maximum <code>n</code> clients can be treated at the same time; <code>None</code> means no limit. <code>syslog</code> is the function used to log errors or debug info. It is called syslog because it is used with the same gravity levels, but it can be anything.</p><p>See the example below.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-close_connection"><a href="#val-close_connection" class="anchor"></a><code><span><span class="keyword">val</span> close_connection : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Closes the current socket</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-printf"><a href="#val-printf" class="anchor"></a><code><span><span class="keyword">val</span> printf : <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.out_channel, unit)</span> <span class="xref-unresolved">Stdlib</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Formatter printing in the out channel associated to the connected socket</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-print_string"><a href="#val-print_string" class="anchor"></a><code><span><span class="keyword">val</span> print_string : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Prints a string in the out channel associated to the socket</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-header"><a href="#val-header" class="anchor"></a><code><span><span class="keyword">val</span> header : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Prints a header; cannot be called if part of content part already has been sent</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-wflush"><a href="#val-wflush" class="anchor"></a><code><span><span class="keyword">val</span> wflush : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Flushes the content of the current socket</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-http"><a href="#val-http" class="anchor"></a><code><span><span class="keyword">val</span> http : <span><a href="../Def/index.html#type-httpStatus">Def.httpStatus</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>Output.status conf answer</code> sends the http header where <code>answer</code> represents the answer status.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-http_redirect_temporarily"><a href="#val-http_redirect_temporarily" class="anchor"></a><code><span><span class="keyword">val</span> http_redirect_temporarily : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>Output.status conf_redirect url</code> sends the http header where <code>url</code> represents the Location where the request needs to be redirected.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-get_request_and_content"><a href="#val-get_request_and_content" class="anchor"></a><code><span><span class="keyword">val</span> get_request_and_content : 
  <span><span>char <span class="xref-unresolved">Stream</span>.t</span> <span class="arrow">&#45;&gt;</span></span>
  <span>string list</span> * <a href="../Adef/index.html#type-encoded_string">Adef.encoded_string</a></span></code></div><div class="spec-doc"><p>Returns the request from a stream read from a socket.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-wsocket"><a href="#val-wsocket" class="anchor"></a><code><span><span class="keyword">val</span> wsocket : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Unix</span>.file_descr</span></code></div><div class="spec-doc"><p>Returns the last used socket</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-woc"><a href="#val-woc" class="anchor"></a><code><span><span class="keyword">val</span> woc : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Stdlib</span>.out_channel</span></code></div><div class="spec-doc"><p>Return the out_channel associated to the socket</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sock_in"><a href="#val-sock_in" class="anchor"></a><code><span><span class="keyword">val</span> sock_in : <span>string <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div><div class="spec-doc"><p>Names of the files used in windows implementation to communicate http requests and html answers. Default &quot;wserver.sin&quot; and &quot;wserver.sou&quot;. Can have relative or absolute paths.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-sock_out"><a href="#val-sock_out" class="anchor"></a><code><span><span class="keyword">val</span> sock_out : <span>string <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-stop_server"><a href="#val-stop_server" class="anchor"></a><code><span><span class="keyword">val</span> stop_server : <span>string <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div><div class="spec-doc"><p>Name of the file whose presence tells the server to stop (at least one request is necessary to unfreeze the server to make it check that this file exits. Default &quot;STOP_SERVER&quot;. Can have relative or absolute path.</p></div></div><div class="odoc-spec"><div class="spec value anchored" id="val-cgi"><a href="#val-cgi" class="anchor"></a><code><span><span class="keyword">val</span> cgi : <span>bool <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div><div class="spec-doc"><p>CGI (Common Gateway Interface) mode (default false).</p></div></div></div></body></html>